<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paulo van Breugel">

<title>Ecodiv.earth | sdm in grass gis – Species distribution modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./4_model_training.html" rel="prev">
<link href="./images/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/videojs/video.min.js"></script>
<link href="site_libs/quarto-contrib/videojs/video-js.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<meta property="og:title" content="Ecodiv.earth | sdm in grass gis">
<meta property="og:description" content="">
<meta property="og:site_name" content="Species distribution modeling">
<meta name="twitter:title" content="Ecodiv.earth | sdm in grass gis">
<meta name="twitter:description" content="">
<meta name="twitter:site" content="@ecodiv">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Species distribution modeling</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://ecodiv.earth"> <i class="bi bi-home" role="img">
</i> 
<span class="menu-text">Ecodiv.earth</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./5_model_prediction.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model prediction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/logo_SDM2.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_obtaining_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Acquire the data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_data_preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Prepare the data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_model_training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model training</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_model_prediction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A1_grassbasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Working in GRASS GIS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A3_sampledata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Sample data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A4_scriptmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Scripting a map</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#creating-a-future-distribution-map" id="toc-creating-a-future-distribution-map" class="nav-link active" data-scroll-target="#creating-a-future-distribution-map"><span class="header-section-number">5.1</span> Creating a future distribution map</a></li>
  <li><a href="#current-vs-future-distribution" id="toc-current-vs-future-distribution" class="nav-link" data-scroll-target="#current-vs-future-distribution"><span class="header-section-number">5.2</span> Current vs future distribution</a>
  <ul class="collapse">
  <li><a href="#comparing-probability-maps" id="toc-comparing-probability-maps" class="nav-link" data-scroll-target="#comparing-probability-maps"><span class="header-section-number">5.2.1</span> Comparing probability maps</a></li>
  <li><a href="#presence-absence-maps" id="toc-presence-absence-maps" class="nav-link" data-scroll-target="#presence-absence-maps"><span class="header-section-number">5.2.2</span> Presence-absence maps</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-modelprediction" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model prediction</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>A species distribution model trained on one set of environmental variables can be projected onto future climate scenarios to forecast potential shifts in habitat suitability over time. Similarly, models based on a species’ native distribution can help predict its potential range in new areas outside its current habitat. This approach is valuable for assessing the potential risk of species becoming invasive in new regions.</p>
<p>In this section, we’ll use the model developed in <a href="4_model_training.html#sec-4trainthemodel" class="quarto-xref"><span>Section 4.2</span></a> to project the future potential distribution of the Almond-eyed Ringlet (<em>Erebia alberganus</em>) for the period 2081-2100. This projection will use the SSP585 climate scenario from the <em>EC-Earth3-Veg</em> general circulation model.</p>
<section id="creating-a-future-distribution-map" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="creating-a-future-distribution-map"><span class="header-section-number">5.1</span> Creating a future distribution map</h2>
<p>We already downloaded the climate layers for the above-mentioned SSP and GCM in <a href="2_obtaining_data.html#sec-obtainfutureclimatelayers" class="quarto-xref"><span>Section 2.5</span></a>, and saved them in the mapset <span class="style-db">climate_EC_Earth3_Veg</span>. Let’s first make sure we have access to this mapset from the current mapset. As you might remember, we can use the <a href="https://grass.osgeo.org/grass-stable/manuals/g.mapsets.html">g.mapsets</a> module for that.</p>
<div id="exm-HXKf6KsqSt" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 5.1</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="ex">g.mapsets</span> mapset=climate_EC_Earth3_Veg operation=add</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>gs.run_command(</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="st">"g.mapsets"</span>, mapset<span class="op">=</span>[<span class="st">"climate_EC_Earth3_Veg"</span>], operation<span class="op">=</span><span class="st">"add"</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>In the menu, go to <span class="style-menu">Settings → GRASS working environment → Mapset access</span> and select the mapsets <span class="style-db">climate_EC_Earth3_Veg</span>.</p>
</div>
</div>
</div>
<p>We can now use the <a href="https://grass.osgeo.org/grass-stable/manuals/addons/r.maxent.predict.html">r.maxent.predict</a> to apply the previously created Maxent model to this set of climate raster data. The minimum input requirements are the names of the input raster layers and a <span class="style-output">lambdas</span> file and the name of the raster layers for the predictor variables described in the lambdas file. The <span class="style-output">lambdas</span> file was one of the outputs from <span class="style-function">r.maxent.train</span> and can be found in the output folder <span class="style-output">model_01</span>. It has the extension <em>.lambdas</em> and describes the Maxent model.</p>
<p>The names of the raster layers need to be the same as the variable names used to create the Maxent model. If you are not sure, you can check the file <span class="style-file">maxent_explanatory_variable_names.csv</span> in folder with the model out. This file is automatically created by the <span class="style-function">r.maxent.train</span> module and can be found in the <span class="style-output">model_01</span> folder. If the raster names are not the same as the variables used to create the Maxent model, the <span class="style-parameter">variables</span> parameter can be used to provide the right variable names<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div id="exm-CZnP5gebFx" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 5.2</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode" id="annotated-cell-3"><pre class="sourceCode numberSource bash code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode bash"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1"></a><span class="co"># Make sure you are working in the working directory</span></span>
<span id="annotated-cell-3-2"><a href="#annotated-cell-3-2"></a><span class="bu">cd</span> path_to_working_directory</span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3"></a></span>
<span id="annotated-cell-3-4"><a href="#annotated-cell-3-4"></a><span class="co"># Create the future potential distribution map</span></span>
<span id="annotated-cell-3-5"><a href="#annotated-cell-3-5"></a><span class="ex">r.maxent.predict</span> <span class="dt">\</span></span>
<span id="annotated-cell-3-6"><a href="#annotated-cell-3-6"></a>  lambda=model_01/Erebia_alberganus_obs.lambdas <span class="dt">\</span></span>
<span id="annotated-cell-3-7"><a href="#annotated-cell-3-7"></a>  rasters=bio.1,bio.13,bio.14,bio.15,bio.19,bio.2,bio.4,bio.8,bio.9 <span class="dt">\</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-8" class="code-annotation-target"><a href="#annotated-cell-3-8"></a>  variables=bio_1,bio_13,bio_14,bio_15,bio_19,bio_2,bio_4,bio_8,bio_9 <span class="dt">\</span></span>
<span id="annotated-cell-3-9"><a href="#annotated-cell-3-9"></a>  output=E_alberganus_futprob</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="8" data-code-annotation="1">The names of the future bioclim layers differ from the variables, so we need to provided the variable names. Be careful, they need to be given in the same order as the corresponding raster layers.</span>
</dd>
</dl>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="sourceCode" id="annotated-cell-4"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1"></a><span class="co"># Make sure you are working in the working directory</span></span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2"></a>os.chdir(<span class="st">"replace-for-path-to-working-directory"</span>)</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3"></a></span>
<span id="annotated-cell-4-4"><a href="#annotated-cell-4-4"></a><span class="co"># Create the future potential distribution map</span></span>
<span id="annotated-cell-4-5"><a href="#annotated-cell-4-5"></a>gs.run_command(</span>
<span id="annotated-cell-4-6"><a href="#annotated-cell-4-6"></a>    <span class="st">"r.maxent.predict"</span>,</span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7"></a>    lambdafile<span class="op">=</span><span class="st">"model_01/Erebia_alberganus_obs.lambdas"</span>,</span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8"></a>    rasters<span class="op">=</span><span class="st">"bio.1,bio.13,bio.14,bio.15,bio.19,bio.2,bio.4,bio.8,bio.9"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-9" class="code-annotation-target"><a href="#annotated-cell-4-9"></a>    variables<span class="op">=</span><span class="st">"bio_1,bio_13,bio_14,bio_15,bio_19,bio_2,bio_4,bio_8,bio_9"</span>,</span>
<span id="annotated-cell-4-10"><a href="#annotated-cell-4-10"></a>    output<span class="op">=</span><span class="st">"E_alberganus_futprob"</span>,</span>
<span id="annotated-cell-4-11"><a href="#annotated-cell-4-11"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="9" data-code-annotation="1">The names of the future bioclim layers differ from the variables, so we need to provided the variable names. Be careful, they need to be given in the same order as the corresponding raster layers.</span>
</dd>
</dl>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Open the <span class="style-function">r.maxent.predict</span> dialog and run it with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>lambdafile</td>
<td>model_01/Erebia_alberganus_obs.lambdas</td>
</tr>
<tr class="even">
<td>rasters</td>
<td>bio.1,bio.13,bio.14,bio.15,bio.19,bio.2,bio.4,bio.8,bio.9</td>
</tr>
<tr class="odd">
<td>variables <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></td>
<td>bio_1,bio_13,bio_14,bio_15,bio_19,bio_2,bio_4,bio_8,bio_9</td>
</tr>
<tr class="even">
<td>output</td>
<td>E_alberganus_futprob</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="current-vs-future-distribution" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="current-vs-future-distribution"><span class="header-section-number">5.2</span> Current vs future distribution</h2>
<section id="comparing-probability-maps" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="comparing-probability-maps"><span class="header-section-number">5.2.1</span> Comparing probability maps</h3>
<p>There are several ways to compare the predicted current and future distributions of our species. For a visual comparison of the probability maps, it’s essential that both maps use the same color table. To achieve this, we can use the <a href="https://grass.osgeo.org/grass-stable/manuals/r.colors.html">r.colors</a> module to match the color table of the future probability distribution map with that of the current climate distribution layer (<span class="style-data">E_alberganus_probability</span>). This ensures that any differences we see are due to changes in distribution, not color scale variations.</p>
<div id="exm-jsOr4IpXRP" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 5.3</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">r.colors</span> map=E_alberganus_futprob raster=E_alberganus_probability</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>gs.run_command(</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="st">"r.colors"</span>, <span class="bu">map</span><span class="op">=</span><span class="st">"E_alberganus_futprob"</span>, raster<span class="op">=</span><span class="st">"E_alberganus_probability"</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Open the <span class="style-function">r.colors</span> dialog and run it with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>map</td>
<td>E_alberganus_futprob</td>
</tr>
<tr class="even">
<td>raster</td>
<td>E_alberganus_probability</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Examining the resulting map reveals that by 2081, the potential distribution area of the Almond-eyed Ringlet is projected to decrease significantly under SSP585 (<a href="#fig-futdistr_01" class="quarto-xref">Figure&nbsp;<span>5.1</span></a>). In the Alps, its range is expected to shift to higher altitudes, while in other areas, the species may dissapear entirely.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset exercise">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Future climate conditions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Current climate conditions</a></li></ul>
<div class="tab-content exercise">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div id="fig-futdistr_01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-futdistr_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/E_alberganus_futprob.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;5.1: The raster layer E_alberganus_futprob with the predicted probability of occurrences of Erebia_alberganus in 2081-2100 under the SSP585 climate scenario, based on model_01."><img src="images/E_alberganus_futprob.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-futdistr_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: The raster layer <span class="style-data">E_alberganus_futprob</span> with the predicted probability of occurrences of <em>Erebia_alberganus</em> in 2081-2100 under the SSP585 climate scenario, based on model_01.
</figcaption>
</figure>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div id="fig-probdist_model_01b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-probdist_model_01b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/E_alberganus_probability.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;5.2: The raster layer E_alberganus_probability with the predicted probability of occurrences of Erebia_alberganus, based on model_01."><img src="images/E_alberganus_probability.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-probdist_model_01b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: The raster layer <span class="style-data">E_alberganus_probability</span> with the predicted probability of occurrences of Erebia_alberganus, based on model_01.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>To highlight areas where the changes are expected to happen, we can create a change map by calculating the differences in habitat suitability scores between current and future distributions.</p>
<div id="exm-VjtxwilsRu" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 5.4</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Calculate the change map</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="ex">r.mapcalc</span> <span class="dt">\</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  expression=<span class="st">"E_alb_diff = E_alberganus_futprob - E_alberganus_probability"</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Assign a color table that emphasize differences</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="ex">r.colors</span> map=E_alb_diff color=differences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Calculate the change map</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># Calculate the change map</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>gs.run_command(</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="st">"r.mapcalc"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>    expression<span class="op">=</span><span class="st">"E_alb_diff = E_alberganus_futprob - E_alberganus_probability"</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># Assign a color table that emphasize differences</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>gs.run_command(<span class="st">"r.colors"</span>, <span class="bu">map</span><span class="op">=</span><span class="st">"E_alb_diff"</span>, color<span class="op">=</span><span class="st">"differences"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>Open the <span class="style-function">raster map calculator</span> from the <span class="style-menu">raster</span> and run it with the following expression.</p>
<div id="fig-rastmapchangemap" class="quarto-float quarto-figure quarto-figure-left anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rastmapchangemap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/rastercalculator_changemap01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;5.3: Use the raster map calculator to calculate the differences in habitat suitability scores between current and future distributions."><img src="images/rastercalculator_changemap01.png" class="img-fluid quarto-figure quarto-figure-left figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rastmapchangemap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Use the raster map calculator to calculate the differences in habitat suitability scores between current and future distributions.
</figcaption>
</figure>
</div>
<p>Next, open the <span class="style-function">r.colors</span> module, and run it with the following parameters.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>map</td>
<td>E_alb_diff</td>
</tr>
<tr class="even">
<td>color</td>
<td>differences</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Open the change map tab above to view the resulting map (<a href="#fig-changemap01" class="quarto-xref">Figure&nbsp;<span>5.4</span></a>). This map reinforces our earlier observations: in most areas, climate conditions are predicted to become less suitable, while at higher elevations in the Alps, climate conditions may become more favorable<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="tabset-margin-container"></div><div class="panel-tabset exercise">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Change map</a></li></ul>
<div class="tab-content exercise">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div id="fig-changemap01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-changemap01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/change_map_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;5.4: The change map with negative values (blue) representing where climate conditions are predicted to become (less) suitable for the species, and positive values representing areas where climate conditions are predicted to become more suitable (red). Te inset map shows the region where the species may shift towards higher elevations."><img src="images/change_map_01.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-changemap01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: The change map with negative values (blue) representing where climate conditions are predicted to become (less) suitable for the species, and positive values representing areas where climate conditions are predicted to become more suitable (red). Te inset map shows the region where the species may shift towards higher elevations.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="presence-absence-maps" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="presence-absence-maps"><span class="header-section-number">5.2.2</span> Presence-absence maps</h3>
<p>While the change map is useful for highlighting areas of change, it doesn’t indicate where conditions are, and will remain, unsuitable - or conversely, where they are and will remain suitable. Another way to approach this is to convert the probability maps to presence-absence maps, and subsequently compare these.</p>
<p>For the first step we need to select a threshold value. Raster cells with a probably &gt; threshold value will be converted to 1 (presence), and the other raster cells will be converted to 0 (absence). We’ll use the threshold value that balances the sensitivity<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> and specificity<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. In <a href="4_model_training.html#tbl-relativeimportance" class="quarto-xref">Table&nbsp;<span>4.2</span></a>, we can see that for our model, this is 0.6. After creating the presence-absence map, we assign it a color table using the <a href="https://grass.osgeo.org/grass-stable/manuals/r.colors.html">r.colors</a> module.</p>
<div id="exm-Yc5f3VPPR2" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 5.5</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="sourceCode" id="annotated-cell-9"><pre class="sourceCode numberSource bash code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode bash"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1"></a><span class="co"># Convert the probability under current conditions</span></span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2"></a><span class="ex">r.mapcalc</span> expression=<span class="st">"E_alberganus_bin = if(E_alberganus_probability &lt;0.6,0,1)"</span></span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3"></a></span>
<span id="annotated-cell-9-4"><a href="#annotated-cell-9-4"></a><span class="co"># Convert the probability under future conditions</span></span>
<span id="annotated-cell-9-5"><a href="#annotated-cell-9-5"></a><span class="ex">r.mapcalc</span> expression=<span class="st">"E_alberganus_futbin = if(E_alberganus_futprob &lt;0.6,0,1)"</span></span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6"></a></span>
<span id="annotated-cell-9-7"><a href="#annotated-cell-9-7"></a><span class="co"># Assign white to absence (0) and green to presence (1)</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-8" class="code-annotation-target"><a href="#annotated-cell-9-8"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">"0 white\n1 green"</span> <span class="kw">|</span> <span class="ex">r.colors</span> map=E_alberganus_bin rules=-</span>
<span id="annotated-cell-9-9"><a href="#annotated-cell-9-9"></a><span class="bu">echo</span> <span class="at">-e</span> <span class="st">"0 white\n1 green"</span> <span class="kw">|</span> <span class="ex">r.colors</span> map=E_alberganus_futprob rules=-</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="8" data-code-annotation="1">With <span class="style-function">echo -e</span> you normally print a text to the screen. Here, these are the color instructions. The ‘|’ (pipe) symbol, takes what would have been printed on the screen and sends it directly into the next command, <span class="style-function">r.colors</span>, as input. The <span class="style-parameter">rules=-</span> part tells <span class="style-function">r.colors</span> to get its color instructions from the previous command (instead of a file). The dash (-) means “read from the pipeline,” which is the output of echo.</span>
</dd>
</dl>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="sourceCode" id="annotated-cell-10"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1"></a><span class="co"># Convert the probability to presence-absence under current conditions</span></span>
<span id="annotated-cell-10-2"><a href="#annotated-cell-10-2"></a>gs.run_command(</span>
<span id="annotated-cell-10-3"><a href="#annotated-cell-10-3"></a>    <span class="st">"r.mapcalc"</span>,</span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4"></a>    expression<span class="op">=</span><span class="st">"E_alberganus_presabs = if(E_alberganus_probability &lt;0.6,0,1)"</span>,</span>
<span id="annotated-cell-10-5"><a href="#annotated-cell-10-5"></a>)</span>
<span id="annotated-cell-10-6"><a href="#annotated-cell-10-6"></a></span>
<span id="annotated-cell-10-7"><a href="#annotated-cell-10-7"></a><span class="co"># Convert the probability to presence-absence under future conditions</span></span>
<span id="annotated-cell-10-8"><a href="#annotated-cell-10-8"></a>gs.run_command(</span>
<span id="annotated-cell-10-9"><a href="#annotated-cell-10-9"></a>    <span class="st">"r.mapcalc"</span>,</span>
<span id="annotated-cell-10-10"><a href="#annotated-cell-10-10"></a>    expression<span class="op">=</span><span class="st">"E_alberganus_presabsfut = if(E_alberganus_futprob &lt;0.6,0,1)"</span>,</span>
<span id="annotated-cell-10-11"><a href="#annotated-cell-10-11"></a>)</span>
<span id="annotated-cell-10-12"><a href="#annotated-cell-10-12"></a></span>
<span id="annotated-cell-10-13"><a href="#annotated-cell-10-13"></a><span class="co"># Assign white to absence (0) and green to presence (1)</span></span>
<span id="annotated-cell-10-14"><a href="#annotated-cell-10-14"></a>COLORS <span class="op">=</span> <span class="st">"0 white</span><span class="ch">\n</span><span class="st">1 green"</span></span>
<span id="annotated-cell-10-15"><a href="#annotated-cell-10-15"></a>gs.write_command(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-16" class="code-annotation-target"><a href="#annotated-cell-10-16"></a>    <span class="st">"r.colors"</span>,</span>
<span id="annotated-cell-10-17"><a href="#annotated-cell-10-17"></a>    <span class="bu">map</span><span class="op">=</span><span class="st">"E_alberganus_presabs"</span>,</span>
<span id="annotated-cell-10-18"><a href="#annotated-cell-10-18"></a>    rules<span class="op">=</span><span class="st">"-"</span>,</span>
<span id="annotated-cell-10-19"><a href="#annotated-cell-10-19"></a>    stdin<span class="op">=</span>COLORS,</span>
<span id="annotated-cell-10-20"><a href="#annotated-cell-10-20"></a>) </span>
<span id="annotated-cell-10-21"><a href="#annotated-cell-10-21"></a>gs.write_command(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-22" class="code-annotation-target"><a href="#annotated-cell-10-22"></a>    <span class="st">"r.colors"</span>,</span>
<span id="annotated-cell-10-23"><a href="#annotated-cell-10-23"></a>    <span class="bu">map</span><span class="op">=</span><span class="st">"E_alberganus_presabsfut"</span>,</span>
<span id="annotated-cell-10-24"><a href="#annotated-cell-10-24"></a>    rules<span class="op">=</span><span class="st">"-"</span>,</span>
<span id="annotated-cell-10-25"><a href="#annotated-cell-10-25"></a>    stdin<span class="op">=</span>COLORS,</span>
<span id="annotated-cell-10-26"><a href="#annotated-cell-10-26"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="16" data-code-annotation="1">This sets the color table for the raster map E_alberganus_presabs, using the color rules defined in the COLORS variable (0 as white, 1 as green). The color rules are provided directly in the code and passed to the r.colors command via <span class="style-parameter">stdin</span> parameter, eliminating the need for an external file.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="22" data-code-annotation="2">This sets the color table for the raster map E_alberganus_presabsfut, using the color rules defined in the COLORS variable (0 as white, 1 as green). The color rules are provided directly in the code and passed to the r.colors command via <span class="style-parameter">stdin</span> parameter, eliminating the need for an external file.</span>
</dd>
</dl>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Open the <span class="style-menu">raster map calculator</span> in the menu <span class="style-menu">raster → raster map calculator → raster map calculator</span></p>
<div id="fig-catcross" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-catcross-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-catcross" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-presabs_current_bal" class="quarto-float quarto-figure quarto-figure-left anchored" data-group="rmapcalc" data-fig-align="left">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-presabs_current_bal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/presabs_current_bal.png" class="lightbox" data-gallery="rmapcalc" title="Figure&nbsp;5.5&nbsp;(a): Current conditions"><img src="images/presabs_current_bal.png" class="img-fluid quarto-figure quarto-figure-left figure-img" data-ref-parent="fig-catcross"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-presabs_current_bal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Current conditions
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-catcross" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-presabs_future_bal" class="quarto-float quarto-figure quarto-figure-left anchored" data-group="rmapcalc" data-fig-align="left">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-presabs_future_bal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/presabs_future_bal.png" class="lightbox" data-gallery="rmapcalc" title="Figure&nbsp;5.5&nbsp;(b): Future conditions"><img src="images/presabs_future_bal.png" class="img-fluid quarto-figure quarto-figure-left figure-img" data-ref-parent="fig-catcross"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-presabs_future_bal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Future conditions
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-catcross-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: Convert current and future probability maps to binary maps using the r.mapcalc module.
</figcaption>
</figure>
</div>
<p>Now, assign colors to the two categories absence (0 = white) and presence (1 = green):</p>
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="https://ecodiv.earth/share/sdm_in_grassgis/definecolortableinteractively.mp4"></video></div>
</div>
</div>
</div>
<p>Now we can compare the two maps to identify areas where the species is present both now and in the future, present now but will be absent in the future, absent now but will be present in the future, and absent both now and in the future. We can do this with the <a href="https://grass.osgeo.org/grass-stable/manuals/r.cross.html">r.cross</a> function, which creates a cross product of the category values from multiple raster map layers.</p>
<div id="exm-ZRtKwPOjl3" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 5.6</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="sourceCode" id="annotated-cell-11"><pre class="sourceCode numberSource bash code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode bash"><span id="annotated-cell-11-1"><a href="#annotated-cell-11-1"></a><span class="ex">r.cross</span> <span class="at">-z</span> <span class="dt">\</span></span>
<span id="annotated-cell-11-2"><a href="#annotated-cell-11-2"></a>  input=E_alberganus_presabs,E_alberganus_presabsfut <span class="dt">\</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="1">1</button><span id="annotated-cell-11-3" class="code-annotation-target"><a href="#annotated-cell-11-3"></a>  output=E_alberganus_presabschange</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-11" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="3" data-code-annotation="1">The <span class="style-parameter">-z</span> flag tells r.cross to ignore raster cells with no data.</span>
</dd>
</dl>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="sourceCode" id="annotated-cell-12"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-12-1"><a href="#annotated-cell-12-1"></a>gs.run_command(</span>
<span id="annotated-cell-12-2"><a href="#annotated-cell-12-2"></a>    <span class="st">"r.cross"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1">1</button><span id="annotated-cell-12-3" class="code-annotation-target"><a href="#annotated-cell-12-3"></a>    flags<span class="op">=</span><span class="st">"n"</span>,</span>
<span id="annotated-cell-12-4"><a href="#annotated-cell-12-4"></a>    <span class="bu">input</span><span class="op">=</span><span class="st">"E_alberganus_presabs,E_alberganus_presabsfut"</span>,</span>
<span id="annotated-cell-12-5"><a href="#annotated-cell-12-5"></a>    output<span class="op">=</span><span class="st">"E_alberganus_presabschange"</span>,</span>
<span id="annotated-cell-12-6"><a href="#annotated-cell-12-6"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="3" data-code-annotation="1">The <span class="style-parameter">-z</span> flag tells r.cross to ignore raster cells with no data.</span>
</dd>
</dl>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>Open the <span class="style-menu">r.cross</span> module and run it with the following parameters.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>E_alberganus_presabs,E_alberganus_presabsfut</td>
</tr>
<tr class="even">
<td>output</td>
<td>E_alberganus_presabschange</td>
</tr>
<tr class="odd">
<td>Non-NULL data only (z) <a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To gain a more quantitative perspective on the predicted changes, we can use the <a href="https://grass.osgeo.org/grass-stable/manuals/r.report.html">r.report</a> module, which provides area statistics for each category (<a href="#fig-r_cross_report_01" class="quarto-xref">Figure&nbsp;<span>5.9</span></a>).</p>
<div id="exm-fY8ZAeGbFo" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 5.7</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="sourceCode" id="annotated-cell-13"><pre class="sourceCode numberSource bash code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode bash"><button class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="1">1</button><span id="annotated-cell-13-1" class="code-annotation-target"><a href="#annotated-cell-13-1"></a><span class="ex">r.report</span> <span class="at">-n</span> map=E_alberganus_presabschange <span class="dt">\</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="2">2</button><span id="annotated-cell-13-2" class="code-annotation-target"><a href="#annotated-cell-13-2"></a>  units=kilometers,percent</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-13" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="1" data-code-annotation="1">The <span class="style-parameter">-n</span> flag tells r.report to not report on no data values.</span>
</dd>
<dt data-target-cell="annotated-cell-13" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="2" data-code-annotation="2">You can choose in what unit(s) <span class="style-function">r.report</span> should report the area statistics.</span>
</dd>
</dl>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="sourceCode" id="annotated-cell-14"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1"></a>gs.run_command(</span>
<span id="annotated-cell-14-2"><a href="#annotated-cell-14-2"></a>    <span class="st">"r.report"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1">1</button><span id="annotated-cell-14-3" class="code-annotation-target"><a href="#annotated-cell-14-3"></a>    flags<span class="op">=</span><span class="st">"n"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="2">2</button><span id="annotated-cell-14-4" class="code-annotation-target"><a href="#annotated-cell-14-4"></a>    units<span class="op">=</span><span class="st">"kilometers,percent"</span>,</span>
<span id="annotated-cell-14-5"><a href="#annotated-cell-14-5"></a>    <span class="bu">map</span><span class="op">=</span><span class="st">"E_alberganus_presabschange"</span>,  </span>
<span id="annotated-cell-14-6"><a href="#annotated-cell-14-6"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="3" data-code-annotation="1">The <span class="style-parameter">-n</span> flag tells r.report to not report on no data values.</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="4" data-code-annotation="2">You can choose in what unit(s) <span class="style-function">r.report</span> should report the area statistics.</span>
</dd>
</dl>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>Open the <span class="style-menu">r.report</span> module and run it with the following parameters.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>map</td>
<td>E_alberganus_presabschange</td>
</tr>
<tr class="even">
<td>units <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></td>
<td>kilometers,percent</td>
</tr>
<tr class="odd">
<td>Do not report no data value (n) <a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The map we created in <a href="#exm-ZRtKwPOjl3" class="quarto-xref">step&nbsp;<span>5.6</span></a> shows the predicted presence and absence of <em>Erebia_alberganus</em> under current and future conditions (<a href="#fig-r_cross_01" class="quarto-xref">Figure&nbsp;<span>5.6</span></a>). According to the statistics we calculated in <a href="#exm-fY8ZAeGbFo" class="quarto-xref">step&nbsp;<span>5.7</span></a>, about 98% of the study area is and will remain unsuitable for our species. Currently, 2.15% of the area is classified as suitable for the species. However, projections suggest that this suitability will significantly decrease, with only 0.1% remaining suitable by 2081-2100. Additionally, 0.07% of the area may become newly suitable for the species over this period (<a href="#fig-r_cross_report_01" class="quarto-xref">Figure&nbsp;<span>5.9</span></a>).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset exercise">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">The map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Statistics</a></li></ul>
<div class="tab-content exercise">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div id="fig-r_cross_01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r_cross_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/E_alberganus_presabschange.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;5.6: The raster layer E_alberganus_presabschange with four categories: Category 0 shows areas where the species is predicted to be absent under both current and future conditions; category 1 represents areas where the species is absent now but predicted to be present in the future; category 2 highlights areas where the species is present now but predicted to be absent in the future; and category 3 indicates areas where the species is predicted to be present under both current and future conditions"><img src="images/E_alberganus_presabschange.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r_cross_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6: The raster layer <span class="style-data">E_alberganus_presabschange</span> with four categories: Category 0 shows areas where the species is predicted to be absent under both current and future conditions; category 1 represents areas where the species is absent now but predicted to be present in the future; category 2 highlights areas where the species is present now but predicted to be absent in the future; and category 3 indicates areas where the species is predicted to be present under both current and future conditions
</figcaption>
</figure>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div id="fig-r_cross_report_01" class="quarto-float quarto-figure quarto-figure-left anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r_cross_report_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/r_cross_report_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;5.7: The area statistics for the categorical layer E_alberganus_binchange."><img src="images/r_cross_report_01.png" class="img-fluid quarto-figure quarto-figure-left figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r_cross_report_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.7: The area statistics for the categorical layer <span class="style-data">E_alberganus_binchange</span>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The categories aren’t easy to read, and the colors of the map aren’t necessarily the best to bring out the different categories. We can therefore assign a different color table to the map using <a href="https://grass.osgeo.org/grass-stable/manuals/r.colors.html">r.colors</a> and rename the categories using <a href="https://grass.osgeo.org/grass-stable/manuals/r.category.html">r.category</a>.</p>
<div id="exm-uupyYBTjnJ" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 5.8</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Give the categories more meaningfull names</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="ex">r.category</span> E_alberganus_presabschange separator=<span class="st">":"</span> rules=- <span class="op">&lt;&lt; EOF</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">0:Absent  - Absent</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">1:Absent  - Present</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">2:Present - Absent</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st">3:Present - Present</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="op">EOF</span></span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="ex">r.colors</span> map=E_alberganus_futprob rules=- <span class="op">&lt;&lt; EOF</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="st">0 white</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="st">1 77:175:74</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="st">2 251:154:153</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="st">3 55:126:184</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="op">EOF</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Give the categories more meaningfull names</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>CATS <span class="op">=</span> (</span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="st">"0: Absent  - Absent</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="st">"1: Absent  - Present</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="st">"2: Present - Absent</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="st">"3: Present - Present</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>gs.write_command(</span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="st">"r.category"</span>,</span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="bu">map</span><span class="op">=</span><span class="st">"E_alberganus_presabschange"</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>    separator<span class="op">=</span><span class="st">":"</span>,</span>
<span id="cb8-12"><a href="#cb8-12"></a>    rules<span class="op">=</span><span class="st">"-"</span>,</span>
<span id="cb8-13"><a href="#cb8-13"></a>    stdin<span class="op">=</span>CATS,</span>
<span id="cb8-14"><a href="#cb8-14"></a>)</span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co"># Define colors per category</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>COLORS <span class="op">=</span> <span class="st">"0 white</span><span class="ch">\n</span><span class="st">1 77:175:74</span><span class="ch">\n</span><span class="st">2 251:154:153</span><span class="ch">\n</span><span class="st">3 55:126:184"</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>gs.write_command(</span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="st">"r.colors"</span>,</span>
<span id="cb8-20"><a href="#cb8-20"></a>    <span class="bu">map</span><span class="op">=</span><span class="st">"E_alberganus_presabschange"</span>,</span>
<span id="cb8-21"><a href="#cb8-21"></a>    rules<span class="op">=</span><span class="st">"-"</span>,</span>
<span id="cb8-22"><a href="#cb8-22"></a>    stdin<span class="op">=</span>COLORS,</span>
<span id="cb8-23"><a href="#cb8-23"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p>You can find the <span class="style-function">r.category</span> in the <span class="style-menu">raster</span> menu.</p>
<div id="fig-catcross" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-catcross-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="images/r_category_crossproduct_00.png" class="lightbox" data-gallery="rcat" title="Figure&nbsp;5.8: Using r.category to rename the categories of the raster layer E_alberganus_presabschange (click on the images to enlarge)."><img src="images/r_category_crossproduct_00.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="images/r_category_crossproduct_02.png" class="lightbox" data-gallery="rcat" title="Figure&nbsp;5.8: Using r.category to rename the categories of the raster layer E_alberganus_presabschange (click on the images to enlarge)."><img src="images/r_category_crossproduct_02.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><a href="images/r_category_crossproduct_01.png" class="lightbox" data-gallery="rcat" title="Figure&nbsp;5.8: Using r.category to rename the categories of the raster layer E_alberganus_presabschange (click on the images to enlarge)."><img src="images/r_category_crossproduct_01.png" class="img-fluid figure-img"></a></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-catcross-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.8: Using <span class="style-function">r.category</span> to rename the categories of the raster layer <span class="style-data">E_alberganus_presabschange</span> (click on the images to enlarge).
</figcaption>
</figure>
</div>
<p>To change the colors of the categories, see <a href="#exm-Yc5f3VPPR2" class="quarto-xref">step&nbsp;<span>5.5</span></a>.</p>
</div>
</div>
</div>
<p>Now we can create the map and report with area statistics again by repeating <a href="#exm-fY8ZAeGbFo" class="quarto-xref">step&nbsp;<span>5.7</span></a> The results are, obviously, the same, but hopefully easier to read/interpret.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset exercise">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">The map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Statistics</a></li></ul>
<div class="tab-content exercise">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/change_map_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="The raster layer E_alberganus_presabschange with four categories: Category 0 shows areas where the species is predicted to be absent under both current and future conditions; category 1 represents areas where the species is absent now but predicted to be present in the future; category 2 highlights areas where the species is present now but predicted to be absent in the future; and category 3 indicates areas where the species is predicted to be present under both current and future conditions"><img src="images/change_map_02.png" class="img-fluid figure-img" alt="The raster layer E_alberganus_presabschange with four categories: Category 0 shows areas where the species is predicted to be absent under both current and future conditions; category 1 represents areas where the species is absent now but predicted to be present in the future; category 2 highlights areas where the species is present now but predicted to be absent in the future; and category 3 indicates areas where the species is predicted to be present under both current and future conditions"></a></p>
<figcaption>The raster layer <span class="style-data">E_alberganus_presabschange</span> with four categories: Category 0 shows areas where the species is predicted to be absent under both current and future conditions; category 1 represents areas where the species is absent now but predicted to be present in the future; category 2 highlights areas where the species is present now but predicted to be absent in the future; and category 3 indicates areas where the species is predicted to be present under both current and future conditions</figcaption>
</figure>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div id="fig-r_cross_report_01" class="quarto-float quarto-figure quarto-figure-left anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r_cross_report_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/r_cross_report_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;5.9: The area statistics for the categorical layer E_alberganus_binchange."><img src="images/r_cross_report_02.png" class="img-fluid quarto-figure quarto-figure-left figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r_cross_report_01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.9: The area statistics for the categorical layer <span class="style-data">E_alberganus_binchange</span>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>GRASS GIS includes various other modules that compute and visualize different (change) statistics. A good starting point is to explore the <a href="https://grass.osgeo.org/grass-stable/manuals/index.html">toolbox</a> and the <a href="https://grass.osgeo.org/grass-stable/manuals/addons/">list of addons</a>. You have now completed the basic steps to create and use a species distribution model using Maxent in GRASS GIS. In subsequent sections, which will be available in the coming weeks, we’ll dive deeper into the options, choices, and parameter settings to validate and fine-tune the model.</p>
</section>
</section>
<section id="footnotes" class="level2 unlisted unnumbered">
<h2 class="unlisted unnumbered anchored" data-anchor-id="footnotes">Footnotes</h2>


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-vanswaay2010" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">van Swaay C, Wynhoff I, Verovnik R, et al (2010) Erebia albergana. <span>The IUCN Red List</span> of <span>Threatened Species</span> 2010. IUCN Red List of Threatened Species. <a href="https://doi.org/10.2305/IUCN.UK.2010-1.RLTS.T173278A6984115.en">https://doi.org/10.2305/IUCN.UK.2010-1.RLTS.T173278A6984115.en</a></div>
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Alternatively, the <span class="style-parameter">alias_file</span> parameter can be used to provide a CSV file with the names of the explanatory variables (first column) and the names of the corresponding raster layers (second column).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The names of the future bioclim layers differ from the variables, so we need to provided the variable names. Be careful, they need to be given in the same order as the corresponding raster layers.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>These maps should be interpreted with caution, as they reflect only projected changes in climate conditions and do not account for other potentially important factors.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The ability of the model to correctly identify presence locations, or true positives.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Normally, this is the ability of the model to correctly identify absence locations (true negatives). However, for presence-only models this can be defined as the fraction of the background points predicted to be absent.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>The <span class="style-parameter">-z</span> flag tells r.cross to ignore raster cells with no data.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>You can choose in what unit(s) <span class="style-function">r.report</span> should report the area statistics.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The <span class="style-parameter">-n</span> flag tells r.report to not report on no data values.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ecodiv\.earth\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./4_model_training.html" class="pagination-link" aria-label="Model training">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model training</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> by Ecodiv.earth, 2024.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>videojs(video_shortcode_videojs_video1);</script>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","closeEffect":"zoom","descPosition":"bottom","openEffect":"zoom","loop":false});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>
