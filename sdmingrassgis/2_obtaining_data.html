<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paulo van Breugel">

<title>Ecodiv.earth | sdm in grass gis – Species distribution modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./3_data_preparation.html" rel="next">
<link href="./1_introduction.html" rel="prev">
<link href="./images/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/videojs/video.min.js"></script>
<link href="site_libs/quarto-contrib/videojs/video-js.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<meta property="og:title" content="Ecodiv.earth | sdm in grass gis">
<meta property="og:description" content="">
<meta property="og:site_name" content="Species distribution modeling">
<meta name="twitter:title" content="Ecodiv.earth | sdm in grass gis">
<meta name="twitter:description" content="">
<meta name="twitter:site" content="@ecodiv">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Species distribution modeling</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://ecodiv.earth"> <i class="bi bi-home" role="img">
</i> 
<span class="menu-text">Ecodiv.earth</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./2_obtaining_data.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Acquire the data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/logo_SDM2.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_obtaining_data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Acquire the data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_data_preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Prepare the data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_model_training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model training</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_model_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Model prediction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A1_grassbasics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Working in GRASS GIS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A3_sampledata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Sample data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A4_scriptmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Scripting a map</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-workingdirectory" id="toc-sec-workingdirectory" class="nav-link active" data-scroll-target="#sec-workingdirectory"><span class="header-section-number">2.1</span> Working directory</a></li>
  <li><a href="#sec-baselayers" id="toc-sec-baselayers" class="nav-link" data-scroll-target="#sec-baselayers"><span class="header-section-number">2.2</span> Base layers</a>
  <ul class="collapse">
  <li><a href="#sec-nationalboundaries" id="toc-sec-nationalboundaries" class="nav-link" data-scroll-target="#sec-nationalboundaries"><span class="header-section-number">2.2.1</span> Boundaries</a></li>
  <li><a href="#sec-urban" id="toc-sec-urban" class="nav-link" data-scroll-target="#sec-urban"><span class="header-section-number">2.2.2</span> Urban areas</a></li>
  <li><a href="#sec-roads" id="toc-sec-roads" class="nav-link" data-scroll-target="#sec-roads"><span class="header-section-number">2.2.3</span> Roads</a></li>
  <li><a href="#sec-rivers" id="toc-sec-rivers" class="nav-link" data-scroll-target="#sec-rivers"><span class="header-section-number">2.2.4</span> Rivers</a></li>
  </ul></li>
  <li><a href="#sec-speciesdata" id="toc-sec-speciesdata" class="nav-link" data-scroll-target="#sec-speciesdata"><span class="header-section-number">2.3</span> Species data</a>
  <ul class="collapse">
  <li><a href="#range-map" id="toc-range-map" class="nav-link" data-scroll-target="#range-map"><span class="header-section-number">2.3.1</span> Range map</a></li>
  <li><a href="#occurrence-data" id="toc-occurrence-data" class="nav-link" data-scroll-target="#occurrence-data"><span class="header-section-number">2.3.2</span> Occurrence data</a></li>
  </ul></li>
  <li><a href="#sec-climatedata" id="toc-sec-climatedata" class="nav-link" data-scroll-target="#sec-climatedata"><span class="header-section-number">2.4</span> Current climate</a></li>
  <li><a href="#sec-obtainfutureclimatelayers" id="toc-sec-obtainfutureclimatelayers" class="nav-link" data-scroll-target="#sec-obtainfutureclimatelayers"><span class="header-section-number">2.5</span> Future climates</a></li>
  <li><a href="#code-summary" id="toc-code-summary" class="nav-link" data-scroll-target="#code-summary"><span class="header-section-number">2.6</span> Code summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-data" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Acquire the data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>For this tutorial, we will download and import various data layers that we need to develop a potential distribution model/map for our species, the almond-eyed ringlet (<em>Erebia alberganus</em>). This includes species distribution data and environmental data layers. The almond-eyed ringlet occurs in Europe, so we need a map of Europe to delimit our study area. For visualization purposes, we include some background layers, including a map of the national borders of European countries, rivers, major roads and urban areas in Europe.</p>
<section id="sec-workingdirectory" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sec-workingdirectory"><span class="header-section-number">2.1</span> Working directory</h2>
<p>Certain modules require a file as input or output. You can use the full path to the file. However, if you also define a working directory and you put your files in that working directory. The working directory is a directory where GRASS would look for or output files to if the full path is not specified. That means that you only need to provide the path relative to the working directory. For this section, create your own working directory where you will store the downloaded data.</p>
<div id="exm-qpbGaVxfYh" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.1</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Type <span class="style-function">cd</span> followed by the path to the working directory in the <span class="style-menu">wxGUI Command Console</span>. If you prefer to work on the terminal, run the same on the terminal.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="bu">cd</span> replace-for-path-to-working-directory</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> os</span>
<span id="cb2-2"><a href="#cb2-2"></a>os.chdir(<span class="st">"replace-for-path-to-working-directory"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>The working directory can also be changed in wxGUI menu <span class="style-function">Settings → GRASS working environment → Change working directory</span></p>
<div id="fig-setworkingdirectory" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-setworkingdirectory-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/setworkingdirectory.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;2.1: Set the working directory via the menu or using the command line. After doing so, GRASS will look for files in that location if the full path is not provided."><img src="images/setworkingdirectory.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-setworkingdirectory-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Set the working directory via the menu or using the command line. After doing so, GRASS will look for files in that location if the full path is not provided.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Now, whenever you have to refer to a file, it is enough to specify the name of the file instead of the full path. Note that this applies to external files such as text files or GeoTiff files. This does not apply to raster maps, vector maps and other geospatial data stored in GRASS database which do not need any path to be specified.</p>
</section>
<section id="sec-baselayers" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sec-baselayers"><span class="header-section-number">2.2</span> Base layers</h2>
<p>We’ll download and import a few base layers, including maps of the national boundaries, roads and rivers. For an effective workflow, it is a good idea to organize your data well. For this tutorial, we’ll keep the base layers in the <span class="style-db">PERMANENT</span> mapset. For input data for our modeling and the modeling results, we’ll use separate mapsets.</p>
<section id="sec-nationalboundaries" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="sec-nationalboundaries"><span class="header-section-number">2.2.1</span> Boundaries</h3>
<p>We’ll use the 1:10m scale data from <a href="https://www.naturalearthdata.com/">Natural Earth</a>, a public domain map dataset available at various scales. We download the Shapefile from <a href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/">Admin 0 - countries</a> and unzip the data to the working directory. Next, we import the Shapefile in GRASS GIS as <span class="style-data">admin0</span> using <a href="https://grass.osgeo.org/grass-stable/manuals/v.in.ogr.html">r.in.ogr</a>.</p>
<div id="exm-e84zgDAzAIs" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.2</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">v.in.ogr</span> <span class="dt">\</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  input=ne_10m_admin_0_countries.shp <span class="dt">\</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  output=admin0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>gs.run_command(</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="bu">input</span><span class="op">=</span><span class="st">"ne_10m_admin_0_countries.shp"</span>,</span>
<span id="cb4-4"><a href="#cb4-4"></a>    output<span class="op">=</span><span class="st">"admin0"</span>,</span>
<span id="cb4-5"><a href="#cb4-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Open the <span class="style-function">v.in.ogr</span> dialog and fill in:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Input</td>
<td>ne_10m_admin_0_countries.shp</td>
</tr>
<tr class="even">
<td>Output</td>
<td>admin0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The Almond-eyed Ringlet occurs in parts of Europe, so we’ll limit the areas for which we download the rest of the data to Europe, by setting the extent of the computational region (<a href="A1_grassbasics.html#sec-computationalregion" class="quarto-xref"><span>Section A.7</span></a>). This can be done using <a href="https://grass.osgeo.org/grass-stable/manuals/g.region.html">g.region</a> if we know the north, south, west and east limits, or interactively, using the <span class="style-menu">Set computational region extent interactively</span> option under the <span class="style-menu">Various zoom options</span> <img src="images/zoom-more.png" class="img-fluid"> button. For the latter, see the <span class="paneltabcolor"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></span> tab below.</p>
<div id="exm-7Z3CL3lWfe" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.3</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="ex">g.region</span> n=55 s=35 w=-10 e=33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>gs.run_command(<span class="st">"g.region"</span>, n<span class="op">=</span><span class="dv">55</span>, s<span class="op">=</span><span class="dv">35</span>, w<span class="op">=-</span><span class="dv">10</span>, e<span class="op">=</span><span class="dv">33</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="https://ecodiv.earth/share/sdm_in_grassgis/set_region_extent_interactively.mp4"></video></div>
</div>
</div>
</div>
<p>The next step is to create a vector layer <span class="style-data">aoi</span> with a polygon representing the boundaries of the region’s extent using <a href="https://grass.osgeo.org/grass84/manuals/v.in.region.html">v.in.region</a>.</p>
<div id="exm-skRCyG0NKS" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.4</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="ex">v.in.region</span> output=aoi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>gs.run_command(<span class="st">"v.in.region"</span>, output<span class="op">=</span><span class="st">"aoi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Open the <span class="style-function">v.in.region</span> dialog. Fill in:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>output</td>
<td>aoi</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To save some space, we can use the <span class="style-data">aoi</span> vector layer to clip the <span class="style-data">admin0</span> layer to the spatial bounds of the computational region using <a href="https://grass.osgeo.org/grass-stable/manuals/v.clip.html">v.clip</a>, save the result as <span class="style-data">countries</span>, and subsequently remove the <span class="style-data">admin0</span> layer using the <a href="https://grass.osgeo.org/grass84/manuals/g.remove.html">g.remove</a> module.</p>
<div id="exm-u9sDIGepop" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.5</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="ex">v.clip</span> input=admin0 clip=aoi output=countries</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="ex">g.remove</span> <span class="at">-f</span> type=vector name=admin0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>gs.run_command(<span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"admin0"</span>, clip<span class="op">=</span><span class="st">"aoi"</span>, output<span class="op">=</span><span class="st">"countries"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>gs.run_command(<span class="st">"g.remove"</span>, flags<span class="op">=</span><span class="st">"f"</span>, <span class="bu">type</span><span class="op">=</span><span class="st">"vector"</span>, name<span class="op">=</span><span class="st">"admin0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>Open the <span class="style-function">v.clip</span> dialog, and fill in:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Input</td>
<td>tmp</td>
</tr>
<tr class="even">
<td>Clip</td>
<td>aoi</td>
</tr>
<tr class="odd">
<td>Output</td>
<td>countries</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<!-- ### Land cover {#sec-landcover} -->
<!-- # r.import memory=40000 extent=region resolution=value resolution_value=0.000931 input=/home/paulo/Downloads/118168/Results/u2018_clc2018_v2020_20u1_raster100m/DATA/U2018_CLC2018_V2020_20u1.tif output=U2018_CLC2018_V2020_20u1 

### DEM

https://ec.europa.eu/eurostat/web/gisco/geodata/digital-elevation-model/eu-dem#DD

-->
</section>
<section id="sec-urban" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="sec-urban"><span class="header-section-number">2.2.2</span> Urban areas</h3>
<p>We’ll get the vector layer with urban areas from <a href="https://www.naturalearthdata.com/">Natural Earth</a> as well. Download it from <a href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-urban-area/">here</a> and unzip it into your working directory. Similar to the previous step, we’ll import the data as <span class="style-data">tmp</span> using <span class="style-function">v.in.ogr</span>. To speed up the import, we set the <span class="style-parameter">-r</span> flag to only import the vector features that fall completely or partially into the region’s spatial bounds.</p>
<div id="exm-8Sab3GxEyk" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.6</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a><span class="ex">v.in.ogr</span> <span class="at">-r</span> <span class="dt">\</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  input=ne_10m_urban_areas.shp <span class="dt">\</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  output=tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>gs.run_command(</span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb12-3"><a href="#cb12-3"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb12-4"><a href="#cb12-4"></a>    <span class="bu">input</span><span class="op">=</span><span class="st">"ne_10m_urban_areas.shp"</span>,</span>
<span id="cb12-5"><a href="#cb12-5"></a>    output<span class="op">=</span><span class="st">"tmp"</span>,</span>
<span id="cb12-6"><a href="#cb12-6"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>Open the <span class="style-function">v.in.ogr</span> dialog, and fill in:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Input</td>
<td>ne_10m_urban_areas.shp</td>
</tr>
<tr class="even">
<td>Output</td>
<td>tmp</td>
</tr>
<tr class="odd">
<td>Limit the import to the current region (r)</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Next, we clip the layer to the boundaries of our region with <a href="https://grass.osgeo.org/grass-stable/manuals/v.clip.html">v.clip</a> and remove the temporary data.</p>
<div id="exm-H3BGh5a5Df" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.7</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1"></a><span class="ex">v.clip</span> input=tmp clip=aoi output=urban</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="ex">g.remove</span> <span class="at">-f</span> type=vector name=tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>gs.run_command(<span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"tmp"</span>, clip<span class="op">=</span><span class="st">"aoi"</span>, output<span class="op">=</span><span class="st">"urban"</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>gs.run_command(<span class="st">"g.remove"</span>, flags<span class="op">=</span><span class="st">"f"</span>, <span class="bu">type</span><span class="op">=</span><span class="st">"vector"</span>, name<span class="op">=</span><span class="st">"tmp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Open the <span class="style-function">v.clip</span> dialog, and fill in:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Input</td>
<td>tmp</td>
</tr>
<tr class="even">
<td>Clip</td>
<td>aoi</td>
</tr>
<tr class="odd">
<td>Output</td>
<td>urban</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="sec-roads" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="sec-roads"><span class="header-section-number">2.2.3</span> Roads</h3>
<p>We’ll get the road data from <a href="https://www.naturalearthdata.com/">Natural Earth</a> as well. Download it from <a href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/roads/">here</a> and unzip it into your working directory. Similar to the previous step, we’ll import the data as <span class="style-data">tmp</span> using <span class="style-function">v.in.ogr</span> with the <span class="style-parameter">-r</span> flag.</p>
<p>The vector data includes line features representing roads and ferry routes. Whether a line feature is a road or ferry route is defined in the <span class="style-parameter">featurecla</span> column of the attribute table. We only want to import the roads. We can do this using the <span class="style-parameter">where</span>.The <span class="style-parameter">where</span> takes as SQL <a href="https://www.sqlitetutorial.net/sqlite-where/">Where</a> query as an argument to select the features that match a particular condition.</p>
<div id="exm-cMoYfaHQwQ" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.8</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1"></a><span class="ex">v.in.ogr</span> <span class="at">-r</span> <span class="dt">\</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  input=ne_10m_roads.shp <span class="dt">\</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  where=<span class="st">"featurecla='Road'"</span> <span class="dt">\</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  output=tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>gs.run_command(</span>
<span id="cb16-2"><a href="#cb16-2"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb16-3"><a href="#cb16-3"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>    <span class="bu">input</span><span class="op">=</span><span class="st">"ne_10m_roads.shp"</span>,</span>
<span id="cb16-5"><a href="#cb16-5"></a>    where<span class="op">=</span><span class="st">"featurecla='Road'"</span>,</span>
<span id="cb16-6"><a href="#cb16-6"></a>    output<span class="op">=</span><span class="st">"tmp"</span>,</span>
<span id="cb16-7"><a href="#cb16-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>Open the <span class="style-function">v.in.ogr</span> dialog, and fill in:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Input</td>
<td>ne_10m_roads.shp</td>
</tr>
<tr class="even">
<td>Output</td>
<td>tmp</td>
</tr>
<tr class="odd">
<td>Where</td>
<td><code>featurecla='Road'</code></td>
</tr>
<tr class="even">
<td>Limit the import to the current region (r)</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Next, we clip the layer to the boundaries of our region with <a href="https://grass.osgeo.org/grass-stable/manuals/v.clip.html">v.clip</a> and remove the temporary data.</p>
<p>Clipping this particular data will result in a vector layer without an attribute table. This type of error is often caused by incorrect attribute data, such as hard returns or invalid column names. The latter is the case here. There is a column ‘add’, which GRASS does not accept. There are two ways to fix this. Rename the offending column with <a href="https://grass.osgeo.org/grass-stable/manuals/v.db.renamecolumn.html">v.db.renamecolumn</a> or remove it using <a href="https://grass.osgeo.org/grass-stable/manuals/v.db.dropcolumn.html">v.db.dropcolumn</a>. We’ll go for the latter solution.</p>
<div id="exm-e84zg44AIs" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.9</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Remove problematic column</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="ex">v.db.dropcolumn</span> map=tmp columns=add</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># Clip to aoi spatial bounds</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="ex">v.clip</span> input=tmp clip=aoi output=roads</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co"># Remove temporary data</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="ex">g.remove</span> <span class="at">-f</span> type=vector name=tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Remove problematic column</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>gs.run_command(<span class="st">"v.db.dropcolumn"</span>, <span class="bu">map</span><span class="op">=</span><span class="st">"tmp"</span>, columns<span class="op">=</span><span class="st">"add"</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co"># Clip to aoi spatial bounds</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>gs.run_command(<span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"tmp"</span>, clip<span class="op">=</span><span class="st">"aoi"</span>, output<span class="op">=</span><span class="st">"roads"</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co"># Remove temporary data</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>gs.run_command(<span class="st">"g.remove"</span>, flags<span class="op">=</span><span class="st">"f"</span>, <span class="bu">type</span><span class="op">=</span><span class="st">"vector"</span>, name<span class="op">=</span><span class="st">"tmp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>Open the <span class="style-function">v.db.dropcolumn</span> dialog.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>map</td>
<td>tmp</td>
</tr>
<tr class="even">
<td>column</td>
<td>add</td>
</tr>
</tbody>
</table>
<p>Open the <span class="style-function">v.clip</span> dialog, and fill in:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>tmp</td>
</tr>
<tr class="even">
<td>clip</td>
<td>aoi</td>
</tr>
<tr class="odd">
<td>output</td>
<td>roads</td>
</tr>
</tbody>
</table>
<p>Open the <span class="style-function">g.remove</span> dialog, and fill in:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>type</td>
<td>vector</td>
</tr>
<tr class="even">
<td>name</td>
<td>tmp</td>
</tr>
<tr class="odd">
<td>Force removal (r)</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="sec-rivers" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="sec-rivers"><span class="header-section-number">2.2.4</span> Rivers</h3>
<p>We get the river data from Natural Earth as well (<a href="https://www.naturalearthdata.com/downloads/10m-physical-vectors/10m-rivers-lake-centerlines/">download link</a>). Download both the <span class="style-db">rivers and lake centerlines</span> and <span class="style-db">Europe supplement</span> Shapefiles and unzip them into your working directory. We’ll use the same steps as above to import these layers.</p>
<div id="exm-TpZKQ69XSJ" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.10</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1"></a><span class="ex">v.in.ogr</span> <span class="at">-r</span> input=ne_10m_rivers_lake_centerlines.shp output=tmp1</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="ex">v.in.ogr</span> <span class="at">-r</span> input=ne_10m_rivers_europe.shp output=tmp2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>gs.run_command(</span>
<span id="cb20-2"><a href="#cb20-2"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb20-3"><a href="#cb20-3"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb20-4"><a href="#cb20-4"></a>    <span class="bu">input</span><span class="op">=</span><span class="st">"ne_10m_rivers_lake_centerlines.shp"</span>,</span>
<span id="cb20-5"><a href="#cb20-5"></a>    output<span class="op">=</span><span class="st">"tmp1"</span>,</span>
<span id="cb20-6"><a href="#cb20-6"></a>)</span>
<span id="cb20-7"><a href="#cb20-7"></a>gs.run_command(</span>
<span id="cb20-8"><a href="#cb20-8"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb20-9"><a href="#cb20-9"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb20-10"><a href="#cb20-10"></a>    <span class="bu">input</span><span class="op">=</span><span class="st">"ne_10m_rivers_europe.shp"</span>,</span>
<span id="cb20-11"><a href="#cb20-11"></a>    output<span class="op">=</span><span class="st">"tmp2"</span>,</span>
<span id="cb20-12"><a href="#cb20-12"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p>To import <span class="style-data">ne_10m_rivers_lake_centerlines.shp</span>, fill in the following parameters in <span class="style-function">v.in.ogr</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>ne_10m_rivers_lake_centerlines.shp</td>
</tr>
<tr class="even">
<td>output</td>
<td>tmp1</td>
</tr>
<tr class="odd">
<td>Limit the import to the current region (r)</td>
<td>✅</td>
</tr>
</tbody>
</table>
<p>And, to import the <span class="style-data">ne_10m_rivers_europe.shp</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>ne_10m_rivers_europe.shp</td>
</tr>
<tr class="even">
<td>output</td>
<td>tmp2</td>
</tr>
<tr class="odd">
<td>Limit the import to the current region (r)</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We now clip the imported layers to the boundaries of the European mainland.</p>
<div id="exm-OtEsqXpc4Z" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.11</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource bas number-lines code-with-copy"><code class="sourceCode"><span id="cb21-1"><a href="#cb21-1"></a>v.clip input=tmp1 clip=aoi output=tmp3</span>
<span id="cb21-2"><a href="#cb21-2"></a>v.clip input=tmp2 clip=aoi output=tmp4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>gs.run_command(<span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"tmp1"</span>, clip<span class="op">=</span><span class="st">"aoi"</span>, output<span class="op">=</span><span class="st">"tmp3"</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>gs.run_command(<span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"tmp2"</span>, clip<span class="op">=</span><span class="st">"aoi"</span>, output<span class="op">=</span><span class="st">"tmp4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p>To clip <span class="style-data">tmp1</span>, open the <span class="style-function">v.clip</span> dialog and fill in the following parameters:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>tmp1</td>
</tr>
<tr class="even">
<td>output</td>
<td>aoi</td>
</tr>
<tr class="odd">
<td>clip</td>
<td>tmp3</td>
</tr>
</tbody>
</table>
<p>And, to clip <span class="style-data">tmp2</span> to the area of interest (aoi):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>tmp2</td>
</tr>
<tr class="even">
<td>output</td>
<td>aoi</td>
</tr>
<tr class="odd">
<td>clip</td>
<td>tmp4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Next step would be to combine the two layers <span class="style-data">tmp3</span> and <span class="style-data">tmp4</span>. However, the columns in the attribute tables of the two layers are different, both in their names and their order. To make these tables compatible, we need to rearrange and rename the columns so that both tables have the same structure. This requires some SQL code, which we can run using the <a href="https://grass.osgeo.org/grass-stable/manuals/db.execute.html">db.execute</a> module. We first rename the original tables.</p>
<div id="exm-HnzBvCZB2Y" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.12</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="sourceCode" id="annotated-cell-23"><pre class="sourceCode numberSource bash code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode bash"><button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="1">1</button><span id="annotated-cell-23-1" class="code-annotation-target"><a href="#annotated-cell-23-1"></a><span class="co"># Rename the attribute tables</span></span>
<span id="annotated-cell-23-2"><a href="#annotated-cell-23-2"></a><span class="ex">db.execute</span> sql=<span class="st">"ALTER TABLE tmp3 RENAME TO tmp3old;"</span></span>
<span id="annotated-cell-23-3"><a href="#annotated-cell-23-3"></a><span class="ex">db.execute</span> sql=<span class="st">"ALTER TABLE tmp4 RENAME TO tmp4old;"</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-23" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-23" data-code-lines="1" data-code-annotation="1">We use the SQLite <a href="https://www.tutorialspoint.com/sqlite/sqlite_alter_command.htm">ALTER TABLE</a> command to renames the existing attribute table. This will decouple them from the vector layer (geometry).</span>
</dd>
</dl>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="sourceCode" id="annotated-cell-24"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-24" data-target-annotation="1">1</button><span id="annotated-cell-24-1" class="code-annotation-target"><a href="#annotated-cell-24-1"></a><span class="co"># Rename the attribute tables</span></span>
<span id="annotated-cell-24-2"><a href="#annotated-cell-24-2"></a>gs.run_command(</span>
<span id="annotated-cell-24-3"><a href="#annotated-cell-24-3"></a>    <span class="st">"db.execute"</span>,</span>
<span id="annotated-cell-24-4"><a href="#annotated-cell-24-4"></a>    sql<span class="op">=</span><span class="st">"ALTER TABLE tmp3 RENAME TO tmp3old;"</span>,</span>
<span id="annotated-cell-24-5"><a href="#annotated-cell-24-5"></a>)</span>
<span id="annotated-cell-24-6"><a href="#annotated-cell-24-6"></a>gs.run_command(</span>
<span id="annotated-cell-24-7"><a href="#annotated-cell-24-7"></a>    <span class="st">"db.execute"</span>,</span>
<span id="annotated-cell-24-8"><a href="#annotated-cell-24-8"></a>    sql<span class="op">=</span><span class="st">"ALTER TABLE tmp4 RENAME TO tmp4old;"</span>,</span>
<span id="annotated-cell-24-9"><a href="#annotated-cell-24-9"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-24" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-24" data-code-lines="1" data-code-annotation="1">We use the SQLite <a href="https://www.tutorialspoint.com/sqlite/sqlite_alter_command.htm">ALTER TABLE</a> command to renames the existing attribute table. This will decouple them from the vector layer (geometry).</span>
</dd>
</dl>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<p>To rename the table <span class="style-data">tmp3</span> to <span class="style-data">tmp3old</span>, open the <span class="style-function">db.execute</span> dialog and, and in the <span class="style-parameter">sql</span> field, we use the SQL <a href="https://www.tutorialspoint.com/sqlite/sqlite_alter_command.htm">ALTER TABLE</a> command to rename the attribute tables of <span class="style-data">tmp3</span><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sql</td>
<td><code>ALTER TABLE tmp3 RENAME TO tmp3old</code></td>
</tr>
</tbody>
</table>
<p>Likewise, to rename the table <span class="style-data">tmp4</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sql</td>
<td><code>ALTER TABLE tmp4 RENAME TO tmp4old</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We then create new tables with a subset of columns from the original tables. We give these new tables the name of the original attribute tables. GRASS will automatically use these now as attribute tables.</p>
<div id="exm-Zr2t5IdNW1" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.13</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="sourceCode" id="annotated-cell-25"><pre class="sourceCode numberSource bash code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode bash"><button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="1">1</button><span id="annotated-cell-25-1" class="code-annotation-target"><a href="#annotated-cell-25-1"></a><span class="co"># Create new tables</span></span>
<span id="annotated-cell-25-2"><a href="#annotated-cell-25-2"></a><span class="ex">db.execute</span> <span class="dt">\</span></span>
<span id="annotated-cell-25-3"><a href="#annotated-cell-25-3"></a>sql=<span class="st">"CREATE TABLE tmp3 AS SELECT cat,scalerank,featurecla,name,label,min_zoom,min_label FROM tmp3old"</span></span>
<span id="annotated-cell-25-4"><a href="#annotated-cell-25-4"></a><span class="ex">db.execute</span> sql= <span class="st">"CREATE TABLE tmp4 AS SELECT cat,scalerank,featurecla,name,label,min_zoom,min_label FROM tmp4old"</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="1" data-code-annotation="1">We use the SQLite <a href="https://www.tutorialspoint.com/sqlite/sqlite_create_table.htm">CREATE TABLE</a> command to create a new table with the original name, but with the correct structure, based on a selection of columns from the table we just renamed in the order we want. Note, this includes the <span class="style-data">cat</span> column, which is used to link the table attributes to the vector features (see <a href="A1_grassbasics.html#sec-attributemanagement" class="quarto-xref"><span>Section A.2.3</span></a>). The new table gets the name of the original table.</span>
</dd>
</dl>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="sourceCode" id="annotated-cell-26"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-26" data-target-annotation="1">1</button><span id="annotated-cell-26-1" class="code-annotation-target"><a href="#annotated-cell-26-1"></a><span class="co"># New attribute tables</span></span>
<span id="annotated-cell-26-2"><a href="#annotated-cell-26-2"></a>gs.run_command(</span>
<span id="annotated-cell-26-3"><a href="#annotated-cell-26-3"></a>    <span class="st">"db.execute"</span>,</span>
<span id="annotated-cell-26-4"><a href="#annotated-cell-26-4"></a>    sql<span class="op">=</span>(</span>
<span id="annotated-cell-26-5"><a href="#annotated-cell-26-5"></a>        <span class="st">"CREATE TABLE tmp3 AS "</span></span>
<span id="annotated-cell-26-6"><a href="#annotated-cell-26-6"></a>        <span class="st">"SELECT cat,scalerank,featurecla,name,label,min_zoom,min_label "</span></span>
<span id="annotated-cell-26-7"><a href="#annotated-cell-26-7"></a>        <span class="st">"FROM tmp3old"</span></span>
<span id="annotated-cell-26-8"><a href="#annotated-cell-26-8"></a>    ),</span>
<span id="annotated-cell-26-9"><a href="#annotated-cell-26-9"></a>)</span>
<span id="annotated-cell-26-10"><a href="#annotated-cell-26-10"></a>gs.run_command(</span>
<span id="annotated-cell-26-11"><a href="#annotated-cell-26-11"></a>    <span class="st">"db.execute"</span>,</span>
<span id="annotated-cell-26-12"><a href="#annotated-cell-26-12"></a>    sql<span class="op">=</span>(</span>
<span id="annotated-cell-26-13"><a href="#annotated-cell-26-13"></a>        <span class="st">"CREATE TABLE tmp4 AS "</span></span>
<span id="annotated-cell-26-14"><a href="#annotated-cell-26-14"></a>        <span class="st">"SELECT cat,scalerank,featurecla,name,label,min_zoom,min_label "</span></span>
<span id="annotated-cell-26-15"><a href="#annotated-cell-26-15"></a>        <span class="st">"FROM tmp4old"</span></span>
<span id="annotated-cell-26-16"><a href="#annotated-cell-26-16"></a>    ),</span>
<span id="annotated-cell-26-17"><a href="#annotated-cell-26-17"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-26" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-26" data-code-lines="1" data-code-annotation="1">We use the SQLite <a href="https://www.tutorialspoint.com/sqlite/sqlite_create_table.htm">CREATE TABLE</a> command to create a new table with the original name, but with the correct structure, based on a selection of columns from the table we just renamed in the order we want. Note, this includes the <span class="style-data">cat</span> column, which is used to link the table attributes to the vector features (see <a href="A1_grassbasics.html#sec-attributemanagement" class="quarto-xref"><span>Section A.2.3</span></a>). The new table gets the name of the original table.</span>
</dd>
</dl>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<p>To create a new attribute tables <span class="style-data">tmp3</span> with a subset of the columns from <span class="style-data">tmp3old</span>, open the <span class="style-function">db.execute</span> dialog, and run it with the following SQL code<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 90%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sql</td>
<td><code>CREATE TABLE tmp3 AS SELECT cat,scalerank,featurecla,name,label,min_zoom,min_label FROM tmp3old</code></td>
</tr>
</tbody>
</table>
<p>And to create a new attribute tables <span class="style-data">tmp4</span> with a subset of the columns from <span class="style-data">tmp4old</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 90%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sql</td>
<td><code>CREATE TABLE tmp4 AS SELECT cat,scalerank,featurecla,name,label,min_zoom,min_label FROM tmp4old</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>After we have assured the attribute tables of both layers have the same structure, we use <a href="https://grass.osgeo.org/grass-stable/manuals/v.patch.html">v.patch</a> to combine them into one layer called <span class="style-data">rivers</span>.</p>
<div id="exm-Qh4ZzKINHT" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.14</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1"></a><span class="ex">v.patch</span> input=tmp3,tmp4 output=rivers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>gs.run_command(<span class="st">"v.patch"</span>, <span class="bu">input</span><span class="op">=</span>[<span class="st">"tmp3"</span>, <span class="st">"tmp4"</span>], output<span class="op">=</span><span class="st">"rivers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<p>To patch the two vector layers <span class="style-data">tmp3</span> and <span class="style-data">tmp4</span>, open the <span class="style-function">v.patch</span> dialog and run the function with the following parameters:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>tmp3,tmp4</td>
</tr>
<tr class="even">
<td>output</td>
<td>rivers</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Last step is to remove the temporary layers. We use <a href="https://grass.osgeo.org/grass-stable/manuals/db.droptable.html">db.droptable</a> to remove the ‘stand-alone’ tables, and <a href="https://grass.osgeo.org/grass-stable/manuals/g.remove.html">g.remove</a> to remove the intermediate vector layers. We use the <span class="style-parameter">pattern</span> parameter and a wildcard to remove all vector layers with a name that start with <span class="style-parameter">tmp</span>. See the <span class="style-function">g.remove</span> <a href="https://grass.osgeo.org/grass-stable/manuals/g.remove.html">manual page</a> for more details.</p>
<div id="exm-FlhdR7On5I" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.15</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="sourceCode" id="annotated-cell-29"><pre class="sourceCode numberSource bash code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode bash"><button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="1">1</button><span id="annotated-cell-29-1" class="code-annotation-target"><a href="#annotated-cell-29-1"></a><span class="ex">db.droptable</span> <span class="at">-f</span> table=tmp3old</span>
<span id="annotated-cell-29-2"><a href="#annotated-cell-29-2"></a><span class="ex">db.droptable</span> <span class="at">-f</span> table=tmp4old</span>
<span id="annotated-cell-29-3"><a href="#annotated-cell-29-3"></a><span class="ex">g.remove</span> <span class="at">-f</span> type=vector pattern=tmp<span class="pp">*</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-29" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="1" data-code-annotation="1">The <span class="style-function">db.droptable</span> module runs the SQLite <a href="https://www.tutorialspoint.com/sqlite/sqlite_drop_table.htm">DROP TABLE</a> function in the background to remove the old table.</span>
</dd>
</dl>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="sourceCode" id="annotated-cell-30"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="1">1</button><span id="annotated-cell-30-1" class="code-annotation-target"><a href="#annotated-cell-30-1"></a>gs.run_command(<span class="st">"db.droptable"</span>, flags<span class="op">=</span><span class="st">"f"</span>, table<span class="op">=</span><span class="st">"tmp3old"</span>)</span>
<span id="annotated-cell-30-2"><a href="#annotated-cell-30-2"></a>gs.run_command(<span class="st">"db.droptable"</span>, flags<span class="op">=</span><span class="st">"f"</span>, table<span class="op">=</span><span class="st">"tmp4old"</span>)</span>
<span id="annotated-cell-30-3"><a href="#annotated-cell-30-3"></a>gs.run_command(<span class="st">"g.remove"</span>, flags<span class="op">=</span><span class="st">"f"</span>, <span class="bu">type</span><span class="op">=</span><span class="st">"vector"</span>, pattern<span class="op">=</span><span class="st">"tmp*"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-30" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="1" data-code-annotation="1">The <span class="style-function">db.droptable</span> module runs the SQLite <a href="https://www.tutorialspoint.com/sqlite/sqlite_drop_table.htm">DROP TABLE</a> function in the background to remove the old table.</span>
</dd>
</dl>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<p>Open the <span class="style-function">db.droptable</span> dialog, and use the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>table</td>
<td>tmp3old</td>
</tr>
</tbody>
</table>
<p>Repeat this, but replace <span class="style-parameter">tmp3old</span> with <span class="style-parameter">tmp4old</span>.</p>
<p>Run <span class="style-function">g.remove</span> with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>type</td>
<td>vector</td>
</tr>
<tr class="even">
<td>pattern</td>
<td>tmp*</td>
</tr>
<tr class="odd">
<td>Force removal (r)</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="fig-baselayers" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-baselayers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/aoi.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2.2: The study area with the main roads, rivers and urban areas. Data sources: Natural Earth."><img src="images/aoi.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-baselayers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: The study area with the main roads, rivers and urban areas. Data sources: Natural Earth.
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-speciesdata" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="sec-speciesdata"><span class="header-section-number">2.3</span> Species data</h2>
<section id="range-map" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="range-map"><span class="header-section-number">2.3.1</span> Range map</h3>
<p>Let’s see what the experts have to say about the distribution of our species. A good starting point is the range maps from the <a href="https://www.iucnredlist.org/">IUCN Red List</a> website. You’ll need to log in first (create an account if you don’t already have one), then use the search bar to find the species (search by scientific name). Note, however, that on the RedList, the use a different scientific name, namely <em>Erebia albergana</em> (that is something to take into account, in some cases, there is no consensus on the scientific name of a species). Download the range data and unzip it into your working directory<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<p>We’ll create a new mapset <span class="style-db">species_data</span> for our species distribution data and import the range map into this mapset.</p>
<div id="exm-XmMn4IG2Mh" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.16</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1"></a><span class="ex">g.mapset</span> <span class="at">-c</span> mapset=species_data</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="ex">v.in.ogr</span> input=data_0.shp output=Erebia_alberganus_rangemap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>gs.run_command(<span class="st">"g.mapset"</span>, flags<span class="op">=</span><span class="st">"c"</span>, mapset<span class="op">=</span><span class="st">"species_data"</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>gs.run_command(</span>
<span id="cb26-3"><a href="#cb26-3"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb26-4"><a href="#cb26-4"></a>    <span class="bu">input</span><span class="op">=</span><span class="st">"data_0.shp"</span>,</span>
<span id="cb26-5"><a href="#cb26-5"></a>    output<span class="op">=</span><span class="st">"Erebia_alberganus_rangemap"</span>,</span>
<span id="cb26-6"><a href="#cb26-6"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<p>Type in <span class="style-function">g.mapset</span> in the console to open the dialog, and use the following parameter settings.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mapset</td>
<td>species_data</td>
</tr>
<tr class="even">
<td>Create mapset if it doesn’t exist (c)</td>
<td>✅</td>
</tr>
</tbody>
</table>
<p>Run <span class="style-function">v.in.ogr</span> with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>data_0.shp</td>
</tr>
<tr class="even">
<td>output</td>
<td>Erebia_alberganus_rangemap</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="occurrence-data" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="occurrence-data"><span class="header-section-number">2.3.2</span> Occurrence data</h3>
<p>The range map on the Red List website shows the boundaries of the area(s) where the species is thought to occur. The Global Biodiversity Information Facility (<a href="https://www.gbif.org/">GBIF</a>) website provides information on where the species has actually been observed. The GBIF data is the type of data typically used for species distribution modeling. GBIF is an international open data infrastructure that provides free and open access to a vast amount of biodiversity data collected over three centuries of natural history exploration, including current observations from citizen scientists, researchers, and automated monitoring programs.</p>
<p>Before downloading data, you must first register on the site. Once logged in, search for <em>Erebia alberganus</em> von Prunner, 1798. Select the result and open the page. Then click on the green button with the number of observations to open the table with observations.</p>
<div id="fig-numerofoccurrences" class="quarto-float quarto-figure quarto-figure-left anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-numerofoccurrences-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/numberofoccurrences.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;2.3: At the time of writing, GBIF had 16468 occurrences of Erebia alberganus."><img src="images/numberofoccurrences.png" class="img-fluid quarto-figure quarto-figure-left figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-numerofoccurrences-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: At the time of writing, GBIF had 16468 occurrences of <em>Erebia alberganus</em>.
</figcaption>
</figure>
</div>
<p>In the new window, apply any filters that you think are important. Note which filters and what settings you used to select the records. Tip: open the map tab and check the map each time you change a filter to see how it affects the selection of observations.</p>
<div id="fig-gbiffilters" class="quarto-float quarto-figure quarto-figure-left anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gbiffilters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/gbifoccurrencefilters.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;2.4: The table shows all occurrence records for our species. In the panel at the left, you can select specific records based on a number of criteria."><img src="images/gbifoccurrencefilters.png" class="img-fluid quarto-figure quarto-figure-left figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gbiffilters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.4: The table shows all occurrence records for our species. In the panel at the left, you can select specific records based on a number of criteria.
</figcaption>
</figure>
</div>
<p>Click on the <span class="style-menu">download</span> tab and select the <span class="style-menu">Simple</span> option. This will take you to the download page. When the download is complete, download the file and unzip into to your data folder <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>The downloaded file is a tab delimited text file, which can be imported with the <a href="https://grass.osgeo.org/grass-stable/manuals/v.in.ascii.html">v.in.ascii</a> module. A more convenient way is to use the <a href="https://grass.osgeo.org/grass-stable/manuals/addons/v.in.gbif.html">v.in.gbif</a> addon. We install the addon, and use this to import the data we just downloaded.</p>
<div id="exm-EZ65hmOvkK" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.17</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1"></a><span class="ex">g.extension</span> extension=v.in.gbif</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="ex">v.in.gbif</span> input=0104058-240626123714530.csv output=Erebia_alberganus_obs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>gs.run_command(<span class="st">"g.extension"</span>, extension<span class="op">=</span><span class="st">"v.in.gbif"</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>gs.run_command(</span>
<span id="cb28-3"><a href="#cb28-3"></a>    <span class="st">"v.in.gbif"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"0104058-240626123714530.csv"</span>, output<span class="op">=</span><span class="st">"Erebia_alberganus_obs"</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<p>Open the <span class="style-function">g.extension</span> dialog, and run it with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Name of mapset (mapset)</td>
<td>v.in.gbif</td>
</tr>
</tbody>
</table>
<p>Now, open the <span class="style-function">v.in.gbif</span> dialog, and run it with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>0104058-240626123714530.csv</td>
</tr>
<tr class="even">
<td>output</td>
<td>Erebia_alberganus_obs</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The GBIF website provides a number of filters to remove problematic records, such as fossil records or observations without location data. Even so, it is good practice to also check the downloaded data carefully for outliers and other possible problems. For example, we can compare the occurrence data with the RED list range map (<a href="#fig-rangemapoccurrences" class="quarto-xref">Figure&nbsp;<span>2.5</span></a>), or compare the country or lower-level administrative subdivisions of the site, as specified in the attribute table, with the location on the map. Besides the obvious errors, you may also encounter observations that are in unexpected, but not impossible locations. In these cases, you will need to look for other information to help you decide whether to include these points in your analysis.</p>
<div id="fig-rangemapoccurrences" class="quarto-float quarto-figure quarto-figure-left anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rangemapoccurrences-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/rangemap.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;2.5: The Red List range map (green outline) and the GBIF occurrence data of Erebia alberganus. See here for the code used to create this map."><img src="images/rangemap.png" class="img-fluid quarto-figure quarto-figure-left figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rangemapoccurrences-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.5: The Red List range map (green outline) and the GBIF occurrence data of <em>Erebia alberganus</em>. See <a href="A4_scriptmap.html#sec-rangemapoccurrences">here</a> for the code used to create this map.
</figcaption>
</figure>
</div>
<p>Although there are some noticeable discrepancies between the range map and the occurrence data, for the sake of this tutorial, we’ll assume that the GBIF data is OK.</p>
</section>
</section>
<section id="sec-climatedata" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="sec-climatedata"><span class="header-section-number">2.4</span> Current climate</h2>
<p>As explanatory variables for the species distribution modeling, we’ll use the 19 <a href="https://www.worldclim.org/data/bioclim.html">bioclimatic variables</a> from Worldclim<span class="citation" data-cites="fick2017">[<a href="references.html#ref-fick2017" role="doc-biblioref">1</a>]</span>. Bioclimatic (or bioclim in short) variables are derived from the monthly temperature and rainfall values in order to generate more biologically meaningful variables<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. They are available in raster format at different resolutions for historical<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> and future conditions. <a href="https://www.worldclim.org/data/worldclim21.html#">Download</a> the 30 arc seconds<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> historical bioclim data (<a href="#fig-worldclim_historic_bioclim" class="quarto-xref">Figure&nbsp;<span>2.6</span></a>) and unzip the GeoTiff files to your working directory.</p>
<div id="fig-worldclim_historic_bioclim" class="quarto-float quarto-figure quarto-figure-left anchored" data-fig-align="left">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-worldclim_historic_bioclim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/worldclim_historic_bioclim.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;2.6: The Worldclim download page for the version 2.1 historical climate data, with the download link for the 30 arc-second bioclim variables."><img src="images/worldclim_historic_bioclim.png" class="img-fluid quarto-figure quarto-figure-left figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-worldclim_historic_bioclim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.6: The Worldclim download page for the version 2.1 historical climate data, with the download link for the 30 arc-second bioclim variables.
</figcaption>
</figure>
</div>
<p>We’ll create a new mapset <span class="style-db">climate</span> to store the climate data, using the <a href="https://grass.osgeo.org/grass-stable/manuals/g.mapset.html">g.mapset</a> module with the <span class="style-parameter">-c</span> flag. Next, we use the <a href="https://grass.osgeo.org/grass-stable/manuals/g.region.html">g.region</a> module to set the boundaries of the region for which we want to import the data. One option is to use the region extent we defined earlier. Or, now that we know more precisely where our species has been observed, we can defined new bounds using the <span class="style-fuction">g.region</span> module with the <span class="style-parameter">n</span>, <span class="style-parameter">s</span>, <span class="style-parameter">e</span>, and <span class="style-parameter">w</span> parameters. We’ll do the latter, and set the extent of the computational region to <em>54N</em>, <em>36S</em>, <em>-10w</em> and <em>32E</em>.</p>
<p>Note that, if the region and the raster layer are not perfectly aligned, the area that is imported will be slightly larger than the computational region. How much larger depends on the resolution of the computational region, as explained in (<a href="A1_grassbasics.html#sec-computationalregion" class="quarto-xref"><span>Section A.7</span></a>). We therefore use the <span class="style-parameter">res</span> parameter to set the resolution to match the resolution of the layers we want to import.</p>
<div id="exm-OgizA6dRXy" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.18</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1"></a><span class="ex">g.mapset</span> <span class="at">-c</span> mapset=climate_current</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="ex">g.region</span> n=54 s=36 w=-10 e=32 res=0.00833</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>gs.run_command(<span class="st">"g.mapset"</span>, flags<span class="op">=</span><span class="st">"c"</span>, mapset<span class="op">=</span><span class="st">"climate_current"</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>gs.run_command(<span class="st">"g.region"</span>, n<span class="op">=</span><span class="dv">54</span>, s<span class="op">=</span><span class="dv">36</span>, w<span class="op">=-</span><span class="dv">10</span>, e<span class="op">=</span><span class="dv">32</span>, res<span class="op">=</span><span class="fl">0.0083</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<p>Type in <span class="style-function">g.mapset</span> in the console to open the dialog, and use the following parameter settings.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Name of mapset (mapset)</td>
<td>climate_current</td>
</tr>
<tr class="even">
<td>Create mapset if it doesn’t exist (c)</td>
<td>✅</td>
</tr>
</tbody>
</table>
<p>Next, run the <span class="style-function">g.region</span> module with the following settings below. Alternatively, you can define the region’s bounds manually in the <span class="style-menu">Map display</span>, as explained in <a href="A1_grassbasics.html#sec-computationalregion" class="quarto-xref"><span>Section A.7</span></a>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Value for the northern edge (n)</td>
<td>54</td>
</tr>
<tr class="even">
<td>Value for the southern edge (s)</td>
<td>36</td>
</tr>
<tr class="odd">
<td>Value for the eastern edge (e)</td>
<td>32</td>
</tr>
<tr class="even">
<td>Value for the western edge (w)</td>
<td>-10</td>
</tr>
<tr class="odd">
<td>2D grid resolution (res)</td>
<td>0.00833</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To import the bioclim data, we use <a href="https://grass.osgeo.org/grass-stable/manuals/r.in.gdal.html">r.in.gdal</a> with the <span class="style-parameter">-r</span> flag to tell GRASS to limit the import of the data to the area defined by the computational region that we defined in the previous step. To speed up the import, we use the <span class="style-parameter">memory</span> parameter to set the maximum memory to be used (in MB) to be equal to the size of the input file (or otherwise to the maximum amount available on your system).</p>
<p>To avoid having to type in the same command 19 times, we can use a small script to automate the process. If you prefer to use the GUI, the <a href="https://grass.osgeo.org/grass-stable/manuals/r.import.html">r.import</a> functions offers the possibility to batch import layers, as illustrated in the video under the <span class="paneltabcolor"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></span> tab.</p>
<div id="exm-vavvH110fv" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.19</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="sourceCode" id="annotated-cell-37"><pre class="sourceCode numberSource bash code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode bash"><button class="code-annotation-anchor" data-target-cell="annotated-cell-37" data-target-annotation="1">1</button><span id="annotated-cell-37-1" class="code-annotation-target"><a href="#annotated-cell-37-1"></a><span class="va">base</span><span class="op">=</span><span class="st">"wc2.1_30s_bio_"</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-37" data-target-annotation="2">2</button><span id="annotated-cell-37-2" class="code-annotation-target"><a href="#annotated-cell-37-2"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">19</span><span class="dt">}</span><span class="kw">;</span> <span class="cf">do</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-37" data-target-annotation="3">3</button><span id="annotated-cell-37-3" class="code-annotation-target"><a href="#annotated-cell-37-3"></a>    <span class="va">input</span><span class="op">=</span><span class="st">"</span><span class="va">${base}${n}</span><span class="st">.tif"</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-37" data-target-annotation="4">4</button><span id="annotated-cell-37-4" class="code-annotation-target"><a href="#annotated-cell-37-4"></a>    <span class="va">output</span><span class="op">=</span><span class="st">"bio_</span><span class="va">${n}</span><span class="st">"</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-37" data-target-annotation="5">5</button><span id="annotated-cell-37-5" class="code-annotation-target"><a href="#annotated-cell-37-5"></a>    <span class="ex">r.in.gdal</span> <span class="at">-r</span> input=<span class="va">${input}</span> output=<span class="va">${output}</span> memory=1000</span>
<span id="annotated-cell-37-6"><a href="#annotated-cell-37-6"></a><span class="cf">done</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-37" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-37" data-code-lines="1" data-code-annotation="1">Change the base name of the GeoTiff files if you downloaded the lower resolution data. In the for loop, the base name, number and file extension will be combined to the name of the file to be imported.</span>
</dd>
<dt data-target-cell="annotated-cell-37" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-37" data-code-lines="2" data-code-annotation="2">The ‘for’ loop will import the layer 1 to 19. Each round, the names of the input and output layers are created and used as input for r.in.gdal.</span>
</dd>
<dt data-target-cell="annotated-cell-37" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-37" data-code-lines="3" data-code-annotation="3">The number and file extension are added to complete the path+name of the file to be imported.</span>
</dd>
<dt data-target-cell="annotated-cell-37" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-37" data-code-lines="4" data-code-annotation="4">The name of the imported raster layer is created by combining the base name (bio_) and the number.</span>
</dd>
<dt data-target-cell="annotated-cell-37" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-37" data-code-lines="5" data-code-annotation="5">The <span class="style-parameter">-r</span> flag is set to limit the import to the regional bounds. To speed up the import, the <span class="style-parameter">memory</span> parameter should be set to be equal to the size of the import file. If that is not possible, use the maximum value that is possible on your system.</span>
</dd>
</dl>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="sourceCode" id="annotated-cell-38"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-38" data-target-annotation="1">1</button><span id="annotated-cell-38-1" class="code-annotation-target"><a href="#annotated-cell-38-1"></a>base <span class="op">=</span> <span class="st">"wc2.1_30s_bio_"</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-38" data-target-annotation="2">2</button><span id="annotated-cell-38-2" class="code-annotation-target"><a href="#annotated-cell-38-2"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">20</span>):</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-38" data-target-annotation="3">3</button><span id="annotated-cell-38-3" class="code-annotation-target"><a href="#annotated-cell-38-3"></a>    <span class="bu">input</span> <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>base<span class="sc">}{</span>n<span class="sc">}</span><span class="ss">.tif"</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-38" data-target-annotation="4">4</button><span id="annotated-cell-38-4" class="code-annotation-target"><a href="#annotated-cell-38-4"></a>    output <span class="op">=</span> <span class="ss">f"bio_</span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">"</span></span>
<span id="annotated-cell-38-5"><a href="#annotated-cell-38-5"></a>    gs.run_command(</span>
<span id="annotated-cell-38-6"><a href="#annotated-cell-38-6"></a>        <span class="st">"r.in.gdal"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-38" data-target-annotation="5">5</button><span id="annotated-cell-38-7" class="code-annotation-target"><a href="#annotated-cell-38-7"></a>        flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="annotated-cell-38-8"><a href="#annotated-cell-38-8"></a>        <span class="bu">input</span><span class="op">=</span><span class="bu">input</span>,</span>
<span id="annotated-cell-38-9"><a href="#annotated-cell-38-9"></a>        output<span class="op">=</span>output,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-38" data-target-annotation="6">6</button><span id="annotated-cell-38-10" class="code-annotation-target"><a href="#annotated-cell-38-10"></a>        memory<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="annotated-cell-38-11"><a href="#annotated-cell-38-11"></a>    )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-38" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-38" data-code-lines="1" data-code-annotation="1">Change the base name of the GeoTiff files if you downloaded the lower resolution data. In the for loop, the base name, number and file extension will be combined to the name of the file to be imported. Note, the assumption is that you have downloaded the GeoTiff files to your working directory.</span>
</dd>
<dt data-target-cell="annotated-cell-38" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-38" data-code-lines="2" data-code-annotation="2">The ‘for’ loop will import the layer 1 to 19. Each round, the names of the input and output layers are created and used as input for r.in.gdal.</span>
</dd>
<dt data-target-cell="annotated-cell-38" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-38" data-code-lines="3" data-code-annotation="3">Because the file names only differ in the last number, we can simply create the name of the input layer by combining the base name (base) and the number (n).</span>
</dd>
<dt data-target-cell="annotated-cell-38" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-38" data-code-lines="4" data-code-annotation="4">Similar, the name of the imported raster layer is created by combining the base name (bio_) and the number.</span>
</dd>
<dt data-target-cell="annotated-cell-38" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-38" data-code-lines="7" data-code-annotation="5">The -r flag is set to limit the import to the regional bounds.</span>
</dd>
<dt data-target-cell="annotated-cell-38" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-38" data-code-lines="10" data-code-annotation="6">To speed up the import, the memory value should be set to be equal to the size of the import file. If that is not possible, use the maximum value that is possible on your system.</span>
</dd>
</dl>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="quarto-video"><video id="video_shortcode_videojs_video2" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="https://ecodiv.earth/share/sdm_in_grassgis/import_climate_data.mp4"></video></div>
</div>
</div>
</div>
<p>As mentioned earlier, GRASS will import raster layers with the resolution and alignment of the original raster files. This means the computational region and the raster layers may not be perfectly aligned. In addition, the region’s resolution may not match that of the imported layers. To check this, you can run <span class="style-function">g.region</span> with the <span class="style-parameter">-g</span> and compare the outcomes with those of the <a href="https://grass.osgeo.org/grass-stable/manuals/r.info.html">r.info</a> module.</p>
<div id="exm-uqHZOxgy43" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.20</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="sourceCode" id="cb31"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1"></a><span class="ex">g.region</span> <span class="at">-p</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="ex">r.info</span> map=bio_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>gs.run_command(<span class="st">"g.region"</span>, flags<span class="op">=</span><span class="st">"p"</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>gs.run_command(<span class="st">"r.info"</span>, <span class="bu">map</span><span class="op">=</span><span class="st">"bio_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<p>Type in <span class="style-function">g.region</span> in the console to open the dialog, and use the following parameter settings.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Print the current region (p)</td>
<td>✅</td>
</tr>
</tbody>
</table>
<p>Open the <span class="style-function">r.info</span> dialog, and run it with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>map</td>
<td>bio_1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To ensure that the region’s settings (extent, resolution, orientation) match those of the imported bioclim layers, we use the <a href="https://grass.osgeo.org/grass-stable/manuals/g.region.html">g.region</a> module again, but this time with the <span class="style-parameter">raster</span> parameter<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. We also use the <span class="style-parameter">save</span> parameter to save the region settings in the named region file <span class="style-data">aoi</span>.</p>
<div id="exm-V0FK3TyzcN" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.21</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1"></a><span class="ex">g.region</span> raster=bio_1 save=aoi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="sourceCode" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>gs.run_command(<span class="st">"g.region raster=bio_1"</span>, save<span class="op">=</span><span class="st">"aoi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<p>Open the dialog of the <span class="style-function">g.region</span> module, and run it with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>raster</td>
<td>bio_1</td>
</tr>
<tr class="even">
<td>Save current region settings in named region file (save)</td>
<td>aoi</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>It is important to note that the geographic region is defined per mapset. It is therefore the computational region of the mapset you are working in that defines the geographic area and resolution in which raster analyses are performed<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>. See the <a href="https://grass.osgeo.org/grass-stable/manuals/g.region.html">manual page</a> for more information.</p>
<p>In Section <a href="#sec-nationalboundaries" class="quarto-xref"><span>2.2.1</span></a> we created the vector layer <span class="style-data">aoi</span>. To avoid confusion, we will replace it with an updated version that represents the boundaries of the region we just defined. To do this, we must first switch to the <span class="style-db">PERMANENT</span> mapset, change the computational region using the settings we just saved, and then use <a href="">v.in.region</a> to create a vector polygon from the region’s extent. Since there is already a vector layer named <span class="style-data">aoi</span>, we use the <span class="style-parameter">–overwrite</span> parameter to overwrite it.</p>
<div id="exm-sm1p6oj49Z" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.22</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="sourceCode" id="cb35"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1"></a><span class="ex">g.mapset</span> mapset=PERMANENT</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="ex">g.region</span> region=aoi@climate_current</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="ex">v.in.region</span> output=aoi <span class="at">--overwrite</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="sourceCode" id="annotated-cell-44"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-44-1"><a href="#annotated-cell-44-1"></a>gs.run_command(<span class="st">"g.mapset"</span>, mapset<span class="op">=</span><span class="st">"PERMANENT"</span>)</span>
<span id="annotated-cell-44-2"><a href="#annotated-cell-44-2"></a>gs.run_command(<span class="st">"g.region "</span>, region<span class="op">=</span><span class="st">"aoi@climate_current"</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-44" data-target-annotation="1">1</button><span id="annotated-cell-44-3" class="code-annotation-target"><a href="#annotated-cell-44-3"></a>gs.run_command(<span class="st">"v.in.region"</span>, output<span class="op">=</span><span class="st">"aoi"</span>, overwrite<span class="op">=</span><span class="va">True</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-44" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-44" data-code-lines="3" data-code-annotation="1">On the command line, <code>--overwrite</code> is used to tell GRASS to overwrite an existing layer. In Python, do do the same, you set the overwrite parameter to True or False</span>
</dd>
</dl>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<p>Run the <span class="style-function">g.mapset</span> module with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mapset</td>
<td>PERMANENT</td>
</tr>
</tbody>
</table>
<p>Open the <span class="style-function">g.region</span> dialog, and run it with the following settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>region</td>
<td>aoi@climate_current</td>
</tr>
</tbody>
</table>
<p>Run the <span class="style-function">v.in.region</span> module with the following parameter settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>output</td>
<td>aoi</td>
</tr>
<tr class="even">
<td>Allow output files to overwrite existing files (overwrite)</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><a href="#fig-bioclimvars" class="quarto-xref">Figure&nbsp;<span>2.7</span></a> shows the bioclimatic maps 1 to 19 that we have just imported for our study area. The maps also show the range map of the Almond-eyed Ringlet butterfly. In case you are interested, see <a href="A4_scriptmap.html#sec-bioclimvars">here</a> for the code used to create the maps.</p>
<div id="fig-bioclimvars" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bioclimvars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_1.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_1.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_2.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_2.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_3.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_3.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_4.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_4.png" class="img-fluid figure-img"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_5.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_5.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_6.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_6.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_7.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_7.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_8.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_8.png" class="img-fluid figure-img"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_9.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_9.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_10.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_10.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_11.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_11.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_12.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_12.png" class="img-fluid figure-img"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_13.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_13.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_14.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_14.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_15.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_15.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_16.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_16.png" class="img-fluid figure-img"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_17.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_17.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_18.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_18.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/bio_19.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/bio_19.png" class="img-fluid figure-img"></a></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bioclimvars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.7: Bioclimatic variable 1 to 19 from <a href="https://www.worldclim.org/data/bioclim.html">Worldclim version 2.0</a>. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the <a href="https://www.iucnredlist.org/species/173278/6984115">IUCN Red List</a>. Click on the image to enlarge and view the maps in detail.
</figcaption>
</figure>
</div>
</section>
<section id="sec-obtainfutureclimatelayers" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="sec-obtainfutureclimatelayers"><span class="header-section-number">2.5</span> Future climates</h2>
<p>To model the potential distribution of our species under future climate conditions, we use downscaled future climate projections from Worldclim. There are bioclim data from 14 different general circulation models (GCMs) available for download. For each GCM, you can choose between data representing projected conditions in the periods (2021–2040, 241–2060, 2061–2080, and 2081-2100). You can furthermore choose between data based on the Shared Socio-economic Pathways (<a href="https://www.carbonbrief.org/cmip6-the-next-generation-of-climate-models-explained">SSPs</a>) 126, 245, 370 and 585. We’ll use the 30 arc-seconds bioclim variables for the period 2081-2100 based on the SSP585 from the GCM <span class="style-data">EC-Earth3-Veg</span>. Download the data and save it to your working directory.</p>
<p>We’ll create a new mapset <span class="style-db">climate_EC_Earth3_Veg</span> to store the climate data using the <a href="https://grass.osgeo.org/grass-stable/manuals/g.mapset.html">g.mapset</a> module. We use the <span class="style-parameter">region</span> parameter to define the computational region. As input, we use the region file <span class="style-db">aoi@climate_current</span> that we created in <a href="#exm-V0FK3TyzcN" class="quarto-xref">step&nbsp;<span>2.21</span></a> <a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>.</p>
<div id="exm-5XQmiajE7Z" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.23</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="sourceCode" id="cb36"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1"></a><span class="ex">g.mapset</span> <span class="at">-c</span> mapset=climate_EC_Earth3_Veg</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="ex">g.region</span> region=aoi@climate_current </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="sourceCode" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>gs.run_command(<span class="st">"g.mapset"</span>, flags<span class="op">=</span><span class="st">"c"</span>, mapset<span class="op">=</span><span class="st">"climate_EC_Earth3_Veg"</span>)</span>
<span id="cb37-2"><a href="#cb37-2"></a>gs.run_command(<span class="st">"g.region"</span>, region<span class="op">=</span><span class="st">"aoi@climate_current"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<p>Type in <span class="style-function">g.mapset</span> in the console to open the dialog, and use the following parameter settings.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Name of mapset (mapset)</td>
<td>climate_EC_Earth3_Veg</td>
</tr>
<tr class="even">
<td>Create mapset if it doesn’t exist (c)</td>
<td>✅</td>
</tr>
</tbody>
</table>
<p>Next, run the <span class="style-function">g.region</span> module with the following settings:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>region</td>
<td>aoi@climate_current</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Unlike the data for current climate conditions, the data consists of one geoTIF file. The file has 19 bands, representing the 19 bioclimatic variables. To verify this, you can use the <a href="https://gdal.org/en/latest/programs/gdalinfo.html">gdalinfo</a> function from the command line.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="sourceCode" id="cb38"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1"></a><span class="ex">gdalinfo</span> wc2.1_30s_bioc_EC-Earth3-Veg_ssp585_2081-2100.tif </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-gdalinfo_futclim" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gdalinfo_futclim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/gdalinfo_futclim.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Figure&nbsp;2.8: gdalifo prints the names and some basic information about each of the bands in the GeoTiff file. The names of the first two bands are marked with a red outline."><img src="images/gdalinfo_futclim.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gdalinfo_futclim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.8: <span class="style-function">gdalifo</span> prints the names and some basic information about each of the bands in the GeoTiff file. The names of the first two bands are marked with a red outline.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The <a href="https://grass.osgeo.org/grass-stable/manuals/r.in.gdal.html">r.in.gdal</a> module conveniently imports each band as a separate layer. The value of the <span class="style-parameter">output</span> parameter will be used as prefix for the name of the imported raster layers, followed by the band number. If possible, use the <span class="style-parameter">memory</span> parameter to increase the memory to be used by the module as this can speed up the import considerably.</p>
<div id="exm-1a5tTJ1LeP" class="hiddendiv theorem example">
<p><span class="theorem-title"><strong>Step 2.24</strong></span> &nbsp;</p>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="interface">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true"><i class="fa-solid fa-terminal" aria-label="terminal"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false"><i class="fa-regular fa-window-restore" aria-label="window-restore"></i></a></li></ul>
<div class="tab-content" data-group="interface">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="sourceCode" id="cb39"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1"></a><span class="ex">r.in.gdal</span> <span class="at">-r</span> input=wc2.1_30s_bioc_EC-Earth3-Veg_ssp585_2081-2100.tif <span class="dt">\</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>output=bio memory=1000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="sourceCode" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>gs.run_command(</span>
<span id="cb40-2"><a href="#cb40-2"></a>    <span class="st">"r.in.gdal"</span>,</span>
<span id="cb40-3"><a href="#cb40-3"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb40-4"><a href="#cb40-4"></a>    <span class="bu">input</span><span class="op">=</span><span class="st">"wc2.1_30s_bioc_EC-Earth3-Veg_ssp585_2081-2100.tif"</span>,</span>
<span id="cb40-5"><a href="#cb40-5"></a>    output<span class="op">=</span><span class="st">"bio"</span>,</span>
<span id="cb40-6"><a href="#cb40-6"></a>    memory<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb40-7"><a href="#cb40-7"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<p>Type in <span class="style-function">r.in.gdal</span> in the console to open the dialog, and use the following parameter settings.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>input</td>
<td>wc2.1_30s_bioc_EC-Earth3-Veg_ssp585_2081-2100.tif</td>
</tr>
<tr class="even">
<td>output</td>
<td>bio</td>
</tr>
<tr class="odd">
<td>memory</td>
<td>1000</td>
</tr>
<tr class="even">
<td>Limit import to current region (r)</td>
<td>✅</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><a href="#fig-futbioclimvars" class="quarto-xref">Figure&nbsp;<span>2.9</span></a> shows the projected bioclimatic conditions for 2081-2100 (bioclim variables 1 to 19) that we have just imported for our study area. The maps also show the range map of the Almond-eyed Ringlet butterfly.</p>
<div id="fig-futbioclimvars" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-futbioclimvars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_1.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_1.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_2.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_2.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_3.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_3.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_4.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_4.png" class="img-fluid figure-img"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_5.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_5.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_6.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_6.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_7.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_7.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_8.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_8.png" class="img-fluid figure-img"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_9.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_9.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_10.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_10.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_11.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_11.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_12.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_12.png" class="img-fluid figure-img"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_13.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_13.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_14.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_14.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_15.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_15.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_16.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_16.png" class="img-fluid figure-img"></a></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_17.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_17.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_18.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_18.png" class="img-fluid figure-img"></a></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<p><a href="images/futbio_19.png" class="lightbox" data-gallery="my-group" title="Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: Worldclim version 2.0. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the IUCN Red List. Click on the image to enlarge and view the maps in detail."><img src="images/futbio_19.png" class="img-fluid figure-img"></a></p>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-futbioclimvars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.9: Projected bioclimatic conditions for the period 2081-2100 based on the SSP585 from the GCM EC-Earth3-Veg. Source: <a href="https://www.worldclim.org/data/bioclim.html">Worldclim version 2.0</a>. The red outlines show the distribution of the Almond-eyed Ringlet butterfly according to the <a href="https://www.iucnredlist.org/species/173278/6984115">IUCN Red List</a>. Click on the image to enlarge and view the maps in detail.
</figcaption>
</figure>
</div>
</section>
<section id="code-summary" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="code-summary"><span class="header-section-number">2.6</span> Code summary</h2>
<p>The following code blocks consolidate all the Python code from this chapter. In the first block, the base layers are imported. The second block handles the import of species data, and the third block imports the climate layers. Input and output layer names are now defined as variables at the beginning, allowing users to easily customize them. This setup simplifies automating the workflow.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true"><i class="fa-brands fa-python" aria-label="python"></i> Base layers</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i> Species data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false"><i class="fa-brands fa-python" aria-label="python"></i> Climate data</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="sourceCode" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Define input variables</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>working_directory <span class="op">=</span> <span class="st">"replace-with-path-to-working-directory"</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>admin_boundary_file <span class="op">=</span> <span class="st">"ne_10m_admin_0_countries.shp"</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>urban_areas_file <span class="op">=</span> <span class="st">"ne_10m_urban_areas.shp"</span></span>
<span id="cb41-5"><a href="#cb41-5"></a>roads_file <span class="op">=</span> <span class="st">"ne_10m_roads.shp"</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>rivers_centerlines_file <span class="op">=</span> <span class="st">"ne_10m_rivers_lake_centerlines.shp"</span></span>
<span id="cb41-7"><a href="#cb41-7"></a>rivers_europe_file <span class="op">=</span> <span class="st">"ne_10m_rivers_europe.shp"</span></span>
<span id="cb41-8"><a href="#cb41-8"></a></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="co"># Define output layer names</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>admin_layer <span class="op">=</span> <span class="st">"admin0"</span></span>
<span id="cb41-11"><a href="#cb41-11"></a>aoi_layer <span class="op">=</span> <span class="st">"aoi"</span></span>
<span id="cb41-12"><a href="#cb41-12"></a>clipped_countries_layer <span class="op">=</span> <span class="st">"countries"</span></span>
<span id="cb41-13"><a href="#cb41-13"></a>urban_layer <span class="op">=</span> <span class="st">"urban"</span></span>
<span id="cb41-14"><a href="#cb41-14"></a>roads_layer <span class="op">=</span> <span class="st">"roads"</span></span>
<span id="cb41-15"><a href="#cb41-15"></a>rivers_layer <span class="op">=</span> <span class="st">"rivers"</span></span>
<span id="cb41-16"><a href="#cb41-16"></a></span>
<span id="cb41-17"><a href="#cb41-17"></a><span class="co"># Set working directory</span></span>
<span id="cb41-18"><a href="#cb41-18"></a><span class="im">import</span> os</span>
<span id="cb41-19"><a href="#cb41-19"></a><span class="im">import</span> grass.script <span class="im">as</span> gs</span>
<span id="cb41-20"><a href="#cb41-20"></a></span>
<span id="cb41-21"><a href="#cb41-21"></a>os.chdir(working_directory)</span>
<span id="cb41-22"><a href="#cb41-22"></a></span>
<span id="cb41-23"><a href="#cb41-23"></a><span class="co"># Import national boundaries</span></span>
<span id="cb41-24"><a href="#cb41-24"></a>gs.run_command(</span>
<span id="cb41-25"><a href="#cb41-25"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb41-26"><a href="#cb41-26"></a>    <span class="bu">input</span><span class="op">=</span>admin_boundary_file,</span>
<span id="cb41-27"><a href="#cb41-27"></a>    output<span class="op">=</span>admin_layer,</span>
<span id="cb41-28"><a href="#cb41-28"></a>)</span>
<span id="cb41-29"><a href="#cb41-29"></a></span>
<span id="cb41-30"><a href="#cb41-30"></a><span class="co"># Set the region and create a vector layer 'aoi_layer' for the region boundaries</span></span>
<span id="cb41-31"><a href="#cb41-31"></a>gs.run_command(<span class="st">"g.region"</span>, n<span class="op">=</span><span class="dv">55</span>, s<span class="op">=</span><span class="dv">35</span>, w<span class="op">=-</span><span class="dv">10</span>, e<span class="op">=</span><span class="dv">33</span>)</span>
<span id="cb41-32"><a href="#cb41-32"></a>gs.run_command(<span class="st">"v.in.region"</span>, output<span class="op">=</span>aoi_layer)</span>
<span id="cb41-33"><a href="#cb41-33"></a></span>
<span id="cb41-34"><a href="#cb41-34"></a><span class="co"># Clip the national boundaries layer to the region boundaries</span></span>
<span id="cb41-35"><a href="#cb41-35"></a>gs.run_command(</span>
<span id="cb41-36"><a href="#cb41-36"></a>    <span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span>admin_layer, clip<span class="op">=</span>aoi_layer, output<span class="op">=</span>clipped_countries_layer</span>
<span id="cb41-37"><a href="#cb41-37"></a>)</span>
<span id="cb41-38"><a href="#cb41-38"></a>gs.run_command(<span class="st">"g.remove"</span>, flags<span class="op">=</span><span class="st">"f"</span>, <span class="bu">type</span><span class="op">=</span><span class="st">"vector"</span>, name<span class="op">=</span>admin_layer)</span>
<span id="cb41-39"><a href="#cb41-39"></a></span>
<span id="cb41-40"><a href="#cb41-40"></a><span class="co"># Import and clip urban areas to the region</span></span>
<span id="cb41-41"><a href="#cb41-41"></a>gs.run_command(</span>
<span id="cb41-42"><a href="#cb41-42"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb41-43"><a href="#cb41-43"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb41-44"><a href="#cb41-44"></a>    <span class="bu">input</span><span class="op">=</span>urban_areas_file,</span>
<span id="cb41-45"><a href="#cb41-45"></a>    output<span class="op">=</span><span class="st">"tmp"</span>,</span>
<span id="cb41-46"><a href="#cb41-46"></a>)</span>
<span id="cb41-47"><a href="#cb41-47"></a>gs.run_command(<span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"tmp"</span>, clip<span class="op">=</span>aoi_layer, output<span class="op">=</span>urban_layer)</span>
<span id="cb41-48"><a href="#cb41-48"></a>gs.run_command(<span class="st">"g.remove"</span>, flags<span class="op">=</span><span class="st">"f"</span>, <span class="bu">type</span><span class="op">=</span><span class="st">"vector"</span>, name<span class="op">=</span><span class="st">"tmp"</span>)</span>
<span id="cb41-49"><a href="#cb41-49"></a></span>
<span id="cb41-50"><a href="#cb41-50"></a><span class="co"># Import and clip roads to the region</span></span>
<span id="cb41-51"><a href="#cb41-51"></a>gs.run_command(</span>
<span id="cb41-52"><a href="#cb41-52"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb41-53"><a href="#cb41-53"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb41-54"><a href="#cb41-54"></a>    <span class="bu">input</span><span class="op">=</span>roads_file,</span>
<span id="cb41-55"><a href="#cb41-55"></a>    where<span class="op">=</span><span class="st">"featurecla='Road'"</span>,</span>
<span id="cb41-56"><a href="#cb41-56"></a>    output<span class="op">=</span><span class="st">"tmp"</span>,</span>
<span id="cb41-57"><a href="#cb41-57"></a>)</span>
<span id="cb41-58"><a href="#cb41-58"></a>gs.run_command(<span class="st">"v.db.dropcolumn"</span>, <span class="bu">map</span><span class="op">=</span><span class="st">"tmp"</span>, columns<span class="op">=</span><span class="st">"add"</span>)</span>
<span id="cb41-59"><a href="#cb41-59"></a>gs.run_command(<span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"tmp"</span>, clip<span class="op">=</span>aoi_layer, output<span class="op">=</span>roads_layer)</span>
<span id="cb41-60"><a href="#cb41-60"></a>gs.run_command(<span class="st">"g.remove"</span>, flags<span class="op">=</span><span class="st">"f"</span>, <span class="bu">type</span><span class="op">=</span><span class="st">"vector"</span>, name<span class="op">=</span><span class="st">"tmp"</span>)</span>
<span id="cb41-61"><a href="#cb41-61"></a></span>
<span id="cb41-62"><a href="#cb41-62"></a><span class="co"># Import and clip rivers layers to the region</span></span>
<span id="cb41-63"><a href="#cb41-63"></a>gs.run_command(</span>
<span id="cb41-64"><a href="#cb41-64"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb41-65"><a href="#cb41-65"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb41-66"><a href="#cb41-66"></a>    <span class="bu">input</span><span class="op">=</span>rivers_centerlines_file,</span>
<span id="cb41-67"><a href="#cb41-67"></a>    output<span class="op">=</span><span class="st">"tmp1"</span>,</span>
<span id="cb41-68"><a href="#cb41-68"></a>)</span>
<span id="cb41-69"><a href="#cb41-69"></a>gs.run_command(</span>
<span id="cb41-70"><a href="#cb41-70"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb41-71"><a href="#cb41-71"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb41-72"><a href="#cb41-72"></a>    <span class="bu">input</span><span class="op">=</span>rivers_europe_file,</span>
<span id="cb41-73"><a href="#cb41-73"></a>    output<span class="op">=</span><span class="st">"tmp2"</span>,</span>
<span id="cb41-74"><a href="#cb41-74"></a>)</span>
<span id="cb41-75"><a href="#cb41-75"></a>gs.run_command(<span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"tmp1"</span>, clip<span class="op">=</span>aoi_layer, output<span class="op">=</span><span class="st">"tmp3"</span>)</span>
<span id="cb41-76"><a href="#cb41-76"></a>gs.run_command(<span class="st">"v.clip"</span>, <span class="bu">input</span><span class="op">=</span><span class="st">"tmp2"</span>, clip<span class="op">=</span>aoi_layer, output<span class="op">=</span><span class="st">"tmp4"</span>)</span>
<span id="cb41-77"><a href="#cb41-77"></a></span>
<span id="cb41-78"><a href="#cb41-78"></a><span class="co"># Prepare and merge the rivers layers into one</span></span>
<span id="cb41-79"><a href="#cb41-79"></a>gs.run_command(</span>
<span id="cb41-80"><a href="#cb41-80"></a>    <span class="st">"db.execute"</span>,</span>
<span id="cb41-81"><a href="#cb41-81"></a>    sql<span class="op">=</span><span class="st">"ALTER TABLE tmp3 RENAME TO tmp3old;"</span>,</span>
<span id="cb41-82"><a href="#cb41-82"></a>)</span>
<span id="cb41-83"><a href="#cb41-83"></a>gs.run_command(</span>
<span id="cb41-84"><a href="#cb41-84"></a>    <span class="st">"db.execute"</span>,</span>
<span id="cb41-85"><a href="#cb41-85"></a>    sql<span class="op">=</span><span class="st">"ALTER TABLE tmp4 RENAME TO tmp4old;"</span>,</span>
<span id="cb41-86"><a href="#cb41-86"></a>)</span>
<span id="cb41-87"><a href="#cb41-87"></a>gs.run_command(</span>
<span id="cb41-88"><a href="#cb41-88"></a>    <span class="st">"db.execute"</span>,</span>
<span id="cb41-89"><a href="#cb41-89"></a>    sql<span class="op">=</span>(</span>
<span id="cb41-90"><a href="#cb41-90"></a>        <span class="st">"CREATE TABLE tmp3 AS "</span></span>
<span id="cb41-91"><a href="#cb41-91"></a>        <span class="st">"SELECT cat,scalerank,featurecla,name,label,min_zoom,min_label "</span></span>
<span id="cb41-92"><a href="#cb41-92"></a>        <span class="st">"FROM tmp3old"</span></span>
<span id="cb41-93"><a href="#cb41-93"></a>    ),</span>
<span id="cb41-94"><a href="#cb41-94"></a>)</span>
<span id="cb41-95"><a href="#cb41-95"></a>gs.run_command(</span>
<span id="cb41-96"><a href="#cb41-96"></a>    <span class="st">"db.execute"</span>,</span>
<span id="cb41-97"><a href="#cb41-97"></a>    sql<span class="op">=</span>(</span>
<span id="cb41-98"><a href="#cb41-98"></a>        <span class="st">"CREATE TABLE tmp4 AS "</span></span>
<span id="cb41-99"><a href="#cb41-99"></a>        <span class="st">"SELECT cat,scalerank,featurecla,name,label,min_zoom,min_label "</span></span>
<span id="cb41-100"><a href="#cb41-100"></a>        <span class="st">"FROM tmp4old"</span></span>
<span id="cb41-101"><a href="#cb41-101"></a>    ),</span>
<span id="cb41-102"><a href="#cb41-102"></a>)</span>
<span id="cb41-103"><a href="#cb41-103"></a>gs.run_command(<span class="st">"v.patch"</span>, <span class="bu">input</span><span class="op">=</span>[<span class="st">"tmp3"</span>, <span class="st">"tmp4"</span>], output<span class="op">=</span>rivers_layer)</span>
<span id="cb41-104"><a href="#cb41-104"></a>gs.run_command(<span class="st">"db.droptable"</span>, flags<span class="op">=</span><span class="st">"f"</span>, table<span class="op">=</span><span class="st">"tmp3old"</span>)</span>
<span id="cb41-105"><a href="#cb41-105"></a>gs.run_command(<span class="st">"db.droptable"</span>, flags<span class="op">=</span><span class="st">"f"</span>, table<span class="op">=</span><span class="st">"tmp4old"</span>)</span>
<span id="cb41-106"><a href="#cb41-106"></a>gs.run_command(<span class="st">"g.remove"</span>, flags<span class="op">=</span><span class="st">"f"</span>, <span class="bu">type</span><span class="op">=</span><span class="st">"vector"</span>, pattern<span class="op">=</span><span class="st">"tmp*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="sourceCode" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Define input variables</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>working_directory <span class="op">=</span> <span class="st">"replace-with-path-to-working-directory"</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>species_rangemap_file <span class="op">=</span> <span class="st">"data_0.shp"</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>species_occurrence_file <span class="op">=</span> <span class="st">"0104058-240626123714530.csv"</span></span>
<span id="cb42-5"><a href="#cb42-5"></a></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="co"># Define output layer names</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>species_rangemap_layer <span class="op">=</span> <span class="st">"Erebia_alberganus_rangemap"</span></span>
<span id="cb42-8"><a href="#cb42-8"></a>species_obs_layer <span class="op">=</span> <span class="st">"Erebia_alberganus_obs"</span></span>
<span id="cb42-9"><a href="#cb42-9"></a></span>
<span id="cb42-10"><a href="#cb42-10"></a><span class="co"># Set working directory</span></span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="im">import</span> os</span>
<span id="cb42-12"><a href="#cb42-12"></a><span class="im">import</span> grass.script <span class="im">as</span> gs</span>
<span id="cb42-13"><a href="#cb42-13"></a></span>
<span id="cb42-14"><a href="#cb42-14"></a>os.chdir(working_directory)</span>
<span id="cb42-15"><a href="#cb42-15"></a></span>
<span id="cb42-16"><a href="#cb42-16"></a><span class="co"># Create new mapset for species data</span></span>
<span id="cb42-17"><a href="#cb42-17"></a>gs.run_command(<span class="st">"g.mapset"</span>, flags<span class="op">=</span><span class="st">"c"</span>, mapset<span class="op">=</span><span class="st">"species_data"</span>)</span>
<span id="cb42-18"><a href="#cb42-18"></a></span>
<span id="cb42-19"><a href="#cb42-19"></a><span class="co"># Import species range map and GBIF occurrence data</span></span>
<span id="cb42-20"><a href="#cb42-20"></a>gs.run_command(</span>
<span id="cb42-21"><a href="#cb42-21"></a>    <span class="st">"v.in.ogr"</span>,</span>
<span id="cb42-22"><a href="#cb42-22"></a>    <span class="bu">input</span><span class="op">=</span>species_rangemap_file,</span>
<span id="cb42-23"><a href="#cb42-23"></a>    output<span class="op">=</span>species_rangemap_layer,</span>
<span id="cb42-24"><a href="#cb42-24"></a>)</span>
<span id="cb42-25"><a href="#cb42-25"></a>gs.run_command(<span class="st">"g.extension"</span>, extension<span class="op">=</span><span class="st">"v.in.gbif"</span>)</span>
<span id="cb42-26"><a href="#cb42-26"></a>gs.run_command(</span>
<span id="cb42-27"><a href="#cb42-27"></a>    <span class="st">"v.in.gbif"</span>,</span>
<span id="cb42-28"><a href="#cb42-28"></a>    <span class="bu">input</span><span class="op">=</span>species_occurrence_file,</span>
<span id="cb42-29"><a href="#cb42-29"></a>    output<span class="op">=</span>species_obs_layer,</span>
<span id="cb42-30"><a href="#cb42-30"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="sourceCode" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># Define input variables</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>working_directory <span class="op">=</span> <span class="st">"replace-with-path-to-working-directory"</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>future_bioclim_file <span class="op">=</span> <span class="st">"wc2.1_30s_bioc_EC-Earth3-Veg_ssp585_2081-2100.tif"</span></span>
<span id="cb43-4"><a href="#cb43-4"></a>bioclim_base <span class="op">=</span> <span class="st">"wc2.1_30s_bio_"</span></span>
<span id="cb43-5"><a href="#cb43-5"></a>bioclim_count <span class="op">=</span> <span class="dv">19</span></span>
<span id="cb43-6"><a href="#cb43-6"></a></span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="co"># Define output layer names</span></span>
<span id="cb43-8"><a href="#cb43-8"></a>aoi_layer <span class="op">=</span> <span class="st">"aoi"</span></span>
<span id="cb43-9"><a href="#cb43-9"></a>clipped_countries_layer <span class="op">=</span> <span class="st">"countries"</span></span>
<span id="cb43-10"><a href="#cb43-10"></a>rivers_layer <span class="op">=</span> <span class="st">"rivers"</span></span>
<span id="cb43-11"><a href="#cb43-11"></a>bioclim_layer_prefix <span class="op">=</span> <span class="st">"bio_"</span></span>
<span id="cb43-12"><a href="#cb43-12"></a>future_bioclim_output <span class="op">=</span> <span class="st">"bio"</span></span>
<span id="cb43-13"><a href="#cb43-13"></a></span>
<span id="cb43-14"><a href="#cb43-14"></a><span class="co"># Set working directory</span></span>
<span id="cb43-15"><a href="#cb43-15"></a><span class="im">import</span> os</span>
<span id="cb43-16"><a href="#cb43-16"></a><span class="im">import</span> grass.script <span class="im">as</span> gs</span>
<span id="cb43-17"><a href="#cb43-17"></a></span>
<span id="cb43-18"><a href="#cb43-18"></a>os.chdir(working_directory)</span>
<span id="cb43-19"><a href="#cb43-19"></a></span>
<span id="cb43-20"><a href="#cb43-20"></a><span class="co"># Create new mapset for current climate data and set the region</span></span>
<span id="cb43-21"><a href="#cb43-21"></a>gs.run_command(<span class="st">"g.mapset"</span>, flags<span class="op">=</span><span class="st">"c"</span>, mapset<span class="op">=</span><span class="st">"climate_current"</span>)</span>
<span id="cb43-22"><a href="#cb43-22"></a>gs.run_command(<span class="st">"g.region"</span>, n<span class="op">=</span><span class="dv">54</span>, s<span class="op">=</span><span class="dv">36</span>, w<span class="op">=-</span><span class="dv">10</span>, e<span class="op">=</span><span class="dv">32</span>, res<span class="op">=</span><span class="fl">0.0083</span>)</span>
<span id="cb43-23"><a href="#cb43-23"></a></span>
<span id="cb43-24"><a href="#cb43-24"></a><span class="co"># Import bioclim layers</span></span>
<span id="cb43-25"><a href="#cb43-25"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, bioclim_count <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb43-26"><a href="#cb43-26"></a>    input_file <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>bioclim_base<span class="sc">}{</span>n<span class="sc">}</span><span class="ss">.tif"</span></span>
<span id="cb43-27"><a href="#cb43-27"></a>    output_file <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>bioclim_layer_prefix<span class="sc">}{</span>n<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb43-28"><a href="#cb43-28"></a>    gs.run_command(</span>
<span id="cb43-29"><a href="#cb43-29"></a>        <span class="st">"r.in.gdal"</span>,</span>
<span id="cb43-30"><a href="#cb43-30"></a>        flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb43-31"><a href="#cb43-31"></a>        <span class="bu">input</span><span class="op">=</span>input_file,</span>
<span id="cb43-32"><a href="#cb43-32"></a>        output<span class="op">=</span>output_file,</span>
<span id="cb43-33"><a href="#cb43-33"></a>        memory<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb43-34"><a href="#cb43-34"></a>    )</span>
<span id="cb43-35"><a href="#cb43-35"></a></span>
<span id="cb43-36"><a href="#cb43-36"></a><span class="co"># Align region to bioclim layers</span></span>
<span id="cb43-37"><a href="#cb43-37"></a>gs.run_command(<span class="st">"g.region raster=bio_1"</span>, save<span class="op">=</span>aoi_layer)</span>
<span id="cb43-38"><a href="#cb43-38"></a></span>
<span id="cb43-39"><a href="#cb43-39"></a><span class="co"># Update aoi vector layer in PERMANENT mapset</span></span>
<span id="cb43-40"><a href="#cb43-40"></a>gs.run_command(<span class="st">"g.mapset"</span>, mapset<span class="op">=</span><span class="st">"PERMANENT"</span>)</span>
<span id="cb43-41"><a href="#cb43-41"></a>gs.run_command(<span class="st">"g.region"</span>, region<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>aoi_layer<span class="sc">}</span><span class="ss">@climate_current"</span>)</span>
<span id="cb43-42"><a href="#cb43-42"></a>gs.run_command(<span class="st">"v.in.region"</span>, output<span class="op">=</span>aoi_layer, overwrite<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb43-43"><a href="#cb43-43"></a></span>
<span id="cb43-44"><a href="#cb43-44"></a><span class="co"># Create new mapset for future climate data and set region</span></span>
<span id="cb43-45"><a href="#cb43-45"></a>gs.run_command(<span class="st">"g.mapset"</span>, flags<span class="op">=</span><span class="st">"c"</span>, mapset<span class="op">=</span><span class="st">"climate_EC_Earth3_Veg"</span>)</span>
<span id="cb43-46"><a href="#cb43-46"></a>gs.run_command(<span class="st">"g.region"</span>, region<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>aoi_layer<span class="sc">}</span><span class="ss">@climate_current"</span>)</span>
<span id="cb43-47"><a href="#cb43-47"></a></span>
<span id="cb43-48"><a href="#cb43-48"></a><span class="co"># Import future bioclim layers</span></span>
<span id="cb43-49"><a href="#cb43-49"></a>gs.run_command(</span>
<span id="cb43-50"><a href="#cb43-50"></a>    <span class="st">"r.in.gdal"</span>,</span>
<span id="cb43-51"><a href="#cb43-51"></a>    flags<span class="op">=</span><span class="st">"r"</span>,</span>
<span id="cb43-52"><a href="#cb43-52"></a>    <span class="bu">input</span><span class="op">=</span>future_bioclim_file,</span>
<span id="cb43-53"><a href="#cb43-53"></a>    output<span class="op">=</span>future_bioclim_output,</span>
<span id="cb43-54"><a href="#cb43-54"></a>    memory<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb43-55"><a href="#cb43-55"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p><br><br></p>
</section>
<section id="footnotes" class="level2 unlisted unnumbered">
<h2 class="unlisted unnumbered anchored" data-anchor-id="footnotes">Footnotes</h2>


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-fick2017" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Fick SE, Hijmans RJ (2017) <span>WorldClim</span> 2: New 1-km spatial resolution climate surfaces for global land areas. International Journal of Climatology 37(12):4302–4315. <a href="https://doi.org/10.1002/joc.5086">https://doi.org/10.1002/joc.5086</a></div>
</div>
<div id="ref-vanswaay2010" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">van Swaay C, Wynhoff I, Verovnik R, et al (2010) Erebia albergana. <span>The IUCN Red List</span> of <span>Threatened Species</span> 2010. IUCN Red List of Threatened Species. <a href="https://doi.org/10.2305/IUCN.UK.2010-1.RLTS.T173278A6984115.en">https://doi.org/10.2305/IUCN.UK.2010-1.RLTS.T173278A6984115.en</a></div>
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Note, this will decouple them from the vector layer (geometry).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We use the SQLite <a href="https://www.tutorialspoint.com/sqlite/sqlite_create_table.htm">CREATE TABLE</a> command to create two new tables with the correct structure, based on a selection of columns from the table we just renamed. Note, this includes the <span class="style-data">cat</span> column, which is used to link the table attributes to the vector features (see <a href="A1_grassbasics.html#sec-attributemanagement" class="quarto-xref"><span>Section A.2.3</span></a>). The new tables get the name of the original tables.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Note that you are required to cite the data when using it in any publication. You can find the citation information on the webpage.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>It is good practice to cite the data you use in your publications. GBIF conveniently provides you with the citation on the download page, including a Digital Object Identifier (DOI). This is a link to a web page that describes your search, including any filters you have set. Copy and save the citation, so you can use it in your report. If you are using a reference manager such as <a href="https://www.zotero.org/">Zotero</a> (highly recommended), you can use the provided BibTex or RIS file to import the reference.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The bioclimatic variables represent annual trends (e.g., mean annual temperature, annual precipitation) seasonality (e.g., annual range in temperature and precipitation) and extreme or limiting environmental factors (e.g., temperature of the coldest and warmest month, and precipitation of the wet and dry quarters).<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>The historical climate data represents climate conditions for the period 1970-2000. For the modeling exercise, they are considered to represent the recent / current climate conditions.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>You can download the data at another resolution as well. If you do, make sure to to adapt the relevant code examples accordingly.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The different options of the <em>g.region</em> function provide a lot of flexibility in to how to define the region. You are encouraged to carefully consider the different options each time you use this module.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Remember, the current region defines the geographic area in which all GRASS displays and raster analyses will be performed. Raster data will be resampled on-the-fly, if necessary, to match the resolution of the current geographic region setting. By default, GRASS uses the nearest neighbor method to resample the raster layer. This might not always be the best method. If not, you need to resample the data yourself, using the most appropriate method. See <span class="style-menu">menu: Raster → Develop raster map</span> for options.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>The <span class="style-data">aoi</span> region file is not stored in the current mapset but in the <span class="style-db">climate_current</span> mapset. We can refer to objects (raster and vector maps and region files) stored in another mapset by appending a <span class="style-parameter">@</span> to the name of the object, followed by the name of the mapset. Strictly speaking, this is not always needed (see the <a href="https://grass.osgeo.org/grass83/manuals/grass_database.html">manual page</a> for details), but it is good practice as it avoids possible confusion if there are layers with the same name in multiple mapsets.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ecodiv\.earth\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./1_introduction.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./3_data_preparation.html" class="pagination-link" aria-label="Prepare the data">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Prepare the data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> by Ecodiv.earth, 2024.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>videojs(video_shortcode_videojs_video1);</script>
<script>videojs(video_shortcode_videojs_video2);</script>
<script>var lightboxQuarto = GLightbox({"loop":true,"descPosition":"bottom","closeEffect":"none","openEffect":"none","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>
